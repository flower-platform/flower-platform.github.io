(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[581],{57741:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>v,frontMatter:()=>c,metadata:()=>h,toc:()=>p});var s=n(85893),r=n(11151),i=n(93598);const o={text:"package com.crispico.leave_management.demoMode;\n\nimport com.crispico.foundation.testGoodies.DemoModeService;\nimport com.crispico.leave_management.BaseDbPopulator;\n\n/**\n * @author Cristian Spiescu\n */\n// #region demo-mode-class\npublic class DemoModeServiceLeaveManagement extends DemoModeService {\n\t\n\t@Override\n\tprotected void populateDbForDemo() {\n\t\t// TODO we need to move the code from BaseDbPopulator, here. I didn't do it now, because there are\n\t\t// a lot of branches that will report a conflict\n\t\tBaseDbPopulator populator = tg.create(BaseDbPopulator.class);\n\t\tpopulator.run();\n// #endregion\n\t}\n\n}\n",path:"leave-management/leave-management-server/src/test/java/com/crispico/leave_management/demoMode/DemoModeServiceLeaveManagement.java"};var a=n(37548);const l={text:"spring:\r\n    main:\r\n        # for beans such as nowService\r\n        allow-bean-definition-overriding: true\r\nfoundation:\r\n    security:\r\n        remember-me:\r\n            enabled: true\r\n\r\n    # need to have access to scheduled taks for DemoRunService client TAD test\r\n    scheduled-task-service:\r\n      organizations: DEFAULT\r\n\r\n#region demo-mode-yml\r\ntest-goodies:\r\n    demo-mode:\r\n        # if false, then the service + scheduler is not instantiated\r\n        enabled: true\r\n        # CRON expression; how often should the repopulation happen\r\n        cron-repopulate-db: 0 0 0 * * *\r\n        # users to create on repopulation; if they exist, the password is updated\r\n        users:\r\n            - username: admin\r\n              password: admin\r\n            - username: test\r\n              password: test\r\n#endregion",path:"foundation-jhg-server/src/main/resources/config-foundation/application-test.yml"},c={title:"Demo mode"},d=void 0,h={id:"foundation-server/demo-mode",title:"Demo mode",description:"Scenarios",source:"@site/docs/foundation-server/demo-mode.md",sourceDirName:"foundation-server",slug:"/foundation-server/demo-mode",permalink:"/docusaurus/docs/foundation-server/demo-mode",draft:!1,unlisted:!1,editUrl:"https://gitlab.xops-online.com/foundation/foundation-jhipster-gwt/-/blob/master/docusaurus/docs/foundation-server/demo-mode.md",tags:[],version:"current",frontMatter:{title:"Demo mode"},sidebar:"tutorialSidebar",previous:{title:"Settings",permalink:"/docusaurus/docs/foundation-server/Settings"},next:{title:"tests-are-demo",permalink:"/docusaurus/docs/category/tests-are-demo"}},u={},p=[{value:"Scenarios",id:"scenarios",level:2},{value:"1/ WHEN the app starts, THEN the DB is repopulated",id:"1-when-the-app-starts-then-the-db-is-repopulated",level:3},{value:"1.1/ A method that we provide is called; it should create demo data",id:"11-a-method-that-we-provide-is-called-it-should-create-demo-data",level:4},{value:"1.2/ Demo users are created (or passwords updated)",id:"12-demo-users-are-created-or-passwords-updated",level:4},{value:"1.3/ The population doesn&#39;t happen during dev + test",id:"13-the-population-doesnt-happen-during-dev--test",level:4},{value:"WHEN the app starts, THEN a scheduled task is created. It repopulates the DB periodically",id:"when-the-app-starts-then-a-scheduled-task-is-created-it-repopulates-the-db-periodically",level:3},{value:"For devs",id:"for-devs",level:2}];function m(e){const t={admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"scenarios",children:"Scenarios"}),"\n",(0,s.jsx)(t.h3,{id:"1-when-the-app-starts-then-the-db-is-repopulated",children:"1/ WHEN the app starts, THEN the DB is repopulated"}),"\n",(0,s.jsx)(t.h4,{id:"11-a-method-that-we-provide-is-called-it-should-create-demo-data",children:"1.1/ A method that we provide is called; it should create demo data"}),"\n",(0,s.jsx)(t.h4,{id:"12-demo-users-are-created-or-passwords-updated",children:"1.2/ Demo users are created (or passwords updated)"}),"\n",(0,s.jsx)(t.p,{children:"Being a demo server, the access is public. It means that anyone can freely connect and maybe mess the data, including the users. That's why, on repopulation, we want the demo users to reset as well. We don't need to provide custom code. Just a list of users + passwords."}),"\n",(0,s.jsx)(t.h4,{id:"13-the-population-doesnt-happen-during-dev--test",children:"1.3/ The population doesn't happen during dev + test"}),"\n",(0,s.jsx)(t.p,{children:"We want to save startup time, because when we launch the app in dev + test mode, we don't always need the DB populated. If we run tests that need DB, they will repopulate it anyway."}),"\n",(0,s.jsx)(t.h3,{id:"when-the-app-starts-then-a-scheduled-task-is-created-it-repopulates-the-db-periodically",children:"WHEN the app starts, THEN a scheduled task is created. It repopulates the DB periodically"}),"\n",(0,s.jsx)(t.p,{children:'We leverage the "Scheduled task" feature.'}),"\n",(0,s.jsx)(t.p,{children:"1/ It means that the DB will be periodically repopulated. Idem cf. above: maybe the user messes a lot the demo data; so a periodic cleaning is good."}),"\n",(0,s.jsx)(t.p,{children:"2/ We remind that there is an UI that shows all the scheduled tasks. It might be interesting for us to manually trigger the repopulation."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(44351).Z+"",width:"710",height:"212"})}),"\n",(0,s.jsx)(t.h2,{id:"for-devs",children:"For devs"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(i.h8,{s:"1"})," We create a class that extends ",(0,s.jsx)(t.code,{children:"DemoModeService"}),". It has only one method. It is called on app startup and via scheduler. It's purpose: to (re)populate the DB w/ demo data."]}),"\n",(0,s.jsx)(i.Tm,{src:o,region:"demo-mode-class"}),"\n",(0,s.jsx)(t.admonition,{type:"tip",children:(0,s.jsxs)(t.p,{children:["Probably your users are ... users, not devs. We recommend to have data that looks good to them. E.g. instead ",(0,s.jsx)(t.em,{children:"User1"}),", ",(0,s.jsx)(t.em,{children:"User2"}),", ",(0,s.jsx)(t.em,{children:"MyUser"})," you might prefer ",(0,s.jsx)(t.em,{children:"John Doe"}),", ",(0,s.jsx)(t.em,{children:"Alex Doyle"}),", etc."]})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(i.h8,{s:"2"})," Instantiate the bean"]}),"\n",(0,s.jsx)(i.Tm,{src:a.Z,region:"demo-mode-bean"}),"\n",(0,s.jsx)(t.admonition,{type:"danger",children:(0,s.jsx)(t.p,{children:"The class should be instantiated ONLY for the demo profile. Don't forget this."})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(i.h8,{s:"3"})," Optional, modify config params"]}),"\n",(0,s.jsx)(t.p,{children:"Below are the available params, together w/ their default config:"}),"\n",(0,s.jsx)(i.sS,{language:"yml",src:l,region:"demo-mode-yml"}),"\n",(0,s.jsx)(t.p,{children:"We consider the above params as being reasonable defaults. But feel free to adjust them. That's why they are configurable \ud83d\ude0a."})]})}function v(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},93598:(e,t,n)=>{"use strict";n.d(t,{sS:()=>h,Tm:()=>u,Fb:()=>p,lj:()=>c,h8:()=>d});n(67294);class s{static now(){return new Date}static consoleLogJson(e,t){void 0===t&&(t=!0);const n=JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if(!t.startsWith("__react")){if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}}})(),2);return t&&console.log(n),n}static substringAfter(e,t,n){const s=n?e.lastIndexOf(t):e.indexOf(t);return s<0?e:e.substring(s+t.length)}static setTimeoutPromise(e,t){return new Promise((n=>setTimeout((()=>{const t=e?.();n(t)}),t)))}}var r=n(9286),i=n(30877),o=n(37839),a=n(91262),l=n(85893);const c=e=>{return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("a",{target:"_blank",href:(t=e.children,"https://gitlab.xops-online.com/foundation/foundation-jhipster-gwt/-/tree/master/"+t+(e.lineNumbers?.[0]?`#L${e.lineNumbers[0]}`:"")+(e.lineNumbers?.[1]?`-L${e.lineNumbers[1]}`:"")),children:[s.substringAfter(e.children,"/",!0),e.region&&(0,l.jsxs)("small",{children:["\xa0",(0,l.jsxs)("i",{children:["(region ",e.region,", between lines [",e.lineNumbers[0],", ",e.lineNumbers[1],"])"]})]})]})});var t},d=e=>(0,l.jsx)(i.Z,{circular:!0,color:"blue",children:e.s}),h=e=>{let{src:{text:t,path:n},region:s,...i}=e;const o=new RegExp(`#region\\s*${s}\\r?\\n(.*?)#endregion`,"s").exec(t);if(!o)throw new Error(`In file = ${n}, cannot find region = ${s}, i.e. a portion like:\n\n#region ${s}\n...\n#endregion`);let a,d=o[1],h=1,u=-1;for(a=0;a<o.index+o[0].length;a++)"\n"===t[a]&&h++,-1===u&&a>=o.index&&(u=h);u++,h--,d="\n"+d;const p=d.match(/\n(\s)*\S/);let m;if(p&&(m=p[1])){const e=new RegExp(`\\n(${m}*)\\S`,"g");let t,n=-1;for(;null!==(t=e.exec(d));)(n<0||n>t[1].length)&&(n=t[1].length);const s=m.repeat(n);d=d.replace(new RegExp("\\n"+s,"g"),"\n")}return d=d.substring(1),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r.Z,{title:(0,l.jsxs)(l.Fragment,{children:["Snippet extracted from ",(0,l.jsx)(c,{region:s,lineNumbers:[u,h],children:n})]}),...i,children:d})})},u=e=>(0,l.jsx)(h,{language:"java",...e}),p=e=>(0,l.jsx)(a.Z,{children:()=>(0,l.jsx)(o.J6,{recordedTestsUrl:"https://gitlab.xops-online.com/foundation/foundation-jhipster-gwt/-/raw/master/leave-management/leave-management-react/public/recordedTests/recordedTest.json",includeCredentialsInJsonRequestRegex:/https:\/\/gitlab\.xops-online\.com\/*/,...e})})},37839:(e,t,n)=>{"use strict";n.d(t,{J6:()=>Lt});var s=n(85893),r=n(67294),i=n(34273),o=n(98066),a=n(99678),l=n(18229),c=n(88970),d=n(91530),h=n(57467),u=n(51082),p=n(187),m=n(82528),v=n(42336),g=n(88081),f=n(57182);function S(e){let t=("horizontal"===e.split?"flex-container-row":"flex-container")+" flex-grow";e.className&&(t+=" "+e.className);const n=(0,s.jsx)(f.Z,Object.assign({},e,{className:t,style:Object.assign(Object.assign({position:"static"},e.style),{flex:"1 1 0"})},{children:e.children}),void 0);return"horizontal"===e.split?(0,s.jsx)("div",Object.assign({className:"flex-grow"},{children:n}),void 0):n}class x{static isTest(){return"undefined"!=typeof process&&void 0!==process.release&&"node"===process.release.name}static now(){return new Date}static consoleLogJson(e,t){void 0===t&&(t=!0);const n=JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if(!t.startsWith("__react")){if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}}})(),2);return t&&console.log(n),n}static substringAfter(e,t,n){const s=n?e.lastIndexOf(t):e.indexOf(t);return s<0?e:e.substring(s+t.length)}static substringBefore(e,t,n){const s=n?e.lastIndexOf(t):e.indexOf(t);return s<0?e:e.substring(0,s)}static getRGBValuesColor(e){var t=[];let n=16711680&e;n>>=16;let s=65280&e;s>>=8;let r=255&e;return t[0]=n,t[1]=s,t[2]=r,t}static getRGBAColor(e,t){var n=x.getRGBValuesColor(e);return"rgba("+n[0]+","+n[1]+","+n[2]+","+t+")"}static convertColorToHex(e){let t=e.toString(16),n=6-t.length;if(0===n)return"#"+t;{let e="";for(let t=0;t<n;t++)e+="0";return"#"+e+t}}static convertColorFromHex(e){if(!(e=e.trim()).startsWith("#"))throw new Error("Color should start with '#'");return e=e.substring(1),parseInt(e,16)}static convertToGrayscale(e){return.299*x.getRGBValuesColor(e)[0]+.587*x.getRGBValuesColor(e)[1]+.114*x.getRGBValuesColor(e)[2]}static getContrastingForegroundColor(e){return x.convertToGrayscale(e)<128?16777215:this.convertColorFromHex(x.DEFAULT_TEXT_COLOR)}static setTimeoutPromise(e,t){return new Promise((n=>setTimeout((()=>{const t=null==e?void 0:e();n(t)}),t)))}}x.DEFAULT_TEXT_COLOR="#000000";var b=n(83059),j=n(80109),w=n(37195),C=n(17658),T=n(8518),y=n(28614),E=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};const N=e=>{let{children:t,enrich:n,baseUrlForImages:r}=e;return t?(0,s.jsx)(b.D,{className:"FeatureBookServer_Markdown",children:t,remarkPlugins:[j.Z],rehypePlugins:[w.Z,C.Z,[T.Z,{content:{type:"element",children:[],tagName:"i",properties:{className:["icon","linkify","small"]}}}]],components:{code(e){var{node:t,inline:n,className:r,children:i}=e,o=E(e,["node","inline","className","children"]);const a=/language-(\w+)/.exec(r||"");return!n&&a?(0,s.jsx)(y.Z,Object.assign({},o,{children:String(i).replace(/\n$/,""),language:a[1],PreTag:"div"}),void 0):(0,s.jsx)("code",Object.assign({},o,{className:r},{children:i}),void 0)}},transformImageUri:e=>r?r+"/"+e:e},void 0):null};var I=n(22408),D=n(4196),O=n.n(D),F=n(54422),P=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))},A=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(n){t[n]=e[n]&&function(t){return new Promise((function(s,r){(function(e,t,n,s){Promise.resolve(s).then((function(t){e({value:t,done:n})}),t)})(s,r,(t=e[n](t)).done,t.value)}))}}};class k{constructor(){this.cache={}}getSourceCodeState(e,t,n){return P(this,void 0,void 0,(function*(){const s=this.getMapFileUrl(e);if(!this.cache[e])try{const t=yield fetch(s);if(!t.ok)throw new Error("Server returned code "+t.status+" - "+t.statusText);const n=yield t.text(),r=new I.TraceMap(JSON.parse(n));this.cache[e]=r}catch(o){return void console.error("Error while processing source-map: fetch",s,o)}const r=(0,I.originalPositionFor)(this.cache[e],{line:t,column:n});if(!r.source||!r.line)return void console.error("Error while processing source-map: originalPositionFor()",s);const i=(0,I.sourceContentFor)(this.cache[e],r.source);if(i)return{sourceCode:i,sourceFile:r.source,sourceLine:r.line,sourceColumn:r.column};console.error("Error while processing source-map: sourceContentFor()",s)}))}decodeStackTrace(e){var t,n,s;return P(this,void 0,void 0,(function*(){let r;if(!e.stack||(r=e.stack.indexOf("\n"))<0)return e.message+" - No stacktrace available";const i=(0,F.Q)(e).map((e=>e.getFunctionName()));let o=null===(s=e.stack)||void 0===s?void 0:s.substring(0,r);const a=O().parse(e);try{for(var l,c=A(a.entries());!(l=yield c.next()).done;){const[e,t]=l.value;if(!t.fileName||!t.lineNumber||!t.columnNumber)continue;const n=yield this.getSourceCodeState(t.fileName,t.lineNumber,t.columnNumber);if(!n)continue;const s=window.location.origin+n.sourceFile.split("..").pop()+":"+n.sourceLine+":"+(n.sourceColumn+1);o+="\n\t "+(i[e]?" at "+i[e]:"")+" ["+n.sourceCode.split("\n")[n.sourceLine-1].trim()+"] ("+s+")"}}catch(d){t={error:d}}finally{try{l&&!l.done&&(n=c.return)&&(yield n.call(c))}finally{if(t)throw t.error}}return o}))}getMapFileUrl(e){let t=e;return e.startsWith("http")||(t=window.location.origin+"/"+e),t.split("?")[0]+".map"}}k.INSTANCE=new k;var R=n(41907),M=n(64077),L=n(7393),Z=n.n(L);class _{constructor(){this.classToName=new Map,this.count=0}getClassName(e){let t=this.classToName.get(e);return t||(t=e.name+"_"+this.count++,this.classToName.set(e,t)),t}getClassNameFromObject(e){return e.constructor.name||(e=Object.getPrototypeOf(Object.getPrototypeOf(e))),this.getClassName(e.constructor)}}_.INSTANCE=new _;const U="$extensions for class$";let B,$;function z(e,t){B=e,$=t}function W(e){if(e||(e=B),!e)throw new Error("Error while calling 'pseudo' annotation. Not called via native decorators, and the global for 'pseudo' decorators is undefined.");let t=e.extensions;return t||(e.extensions=t={}),t}var H=n(58653),J=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};function V(e){const{left:t,top:n,width:s,height:r}=e.getBoundingClientRect();return{x:t+s/2,y:n+r/2}}const G=e=>function(e){if("object"!=typeof e)return!1;let t,n;do{if(n=Object.getPrototypeOf(e),t=Object.prototype.toString.call(n),"[object Element]"===t||"[object Document]"===t)return!0;e=n}while(null!==n);return!1}(e)?V(e):e,q=e=>new Promise((t=>{setTimeout(t,e)}));function K(e,t){let{from:n,to:s,delta:r,steps:i=20,duration:o=500,options:a={}}=t;return J(this,void 0,void 0,(function*(){const t=n||V(e),l=r?{x:t.x+r.x,y:t.y+r.y}:G(s),c=(l.x-t.x)/i,d=(l.y-t.y)/i,h=Object.assign({clientX:t.x,clientY:t.y},a);H.fireEvent.mouseEnter(e,h),H.fireEvent.mouseOver(e,h),H.fireEvent.mouseMove(e,h),H.fireEvent.mouseDown(e,h);for(let n=0;n<i;n++)h.clientX+=c,h.clientY+=d,yield q(o/i),H.fireEvent.mouseMove(e,h);H.fireEvent.mouseUp(e,h)}))}var Q=n(95924),X=n.n(Q),Y=n(92761),ee=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class te{constructor(e){this.master=e,this.files={},this.lastInvocationIndex=0,this.visibleLinesForFirstAndLastChunk=10,this.lastScreenshotNumber=0,this.testIdChainToCountForFileName={},this.recodedTest={slides:[],sourceFiles:{},duration:-1},this.creationTime=(new Date).getTime()}calculateLastScreenshotName(e){let t=(null==e?void 0:e.getAttribute(this.master.testIdProp))?"":"_LAP",n=e;for(;n;){const e=n.getAttribute(this.master.testIdProp);e&&(t=t?e+"_"+t:e),n=n.parentElement}void 0!==this.testIdChainToCountForFileName[t]?(this.testIdChainToCountForFileName[t]++,t+="_REP"+this.testIdChainToCountForFileName[t]):this.testIdChainToCountForFileName[t]=0,this.lastScreenshotNumber++,this.lastScreenshotName=t}onShowSpotlight(e,t){if(this.calculateLastScreenshotName(t),this.messageSentToPuppeteer){const e=`Illegal state: paused/waiting because of \`showSpotlight()\`, but \`showSpotlight()\` called again. Maybe there is somewhere an invocation to a function like \`tad.awaitable...\` w/o prefixing w/ \`await\`?\nOld screenshot = ${JSON.stringify(this.messageSentToPuppeteer,void 0," ")}, new screenshot = ${JSON.stringify(this.createMessageForPuppeteer(),void 0," ")}`;throw new Error(e)}e?this.lastSourceCodeState=e:(this.lastSourceCodeState||(this.lastSourceCodeState={sourceFile:"Source file not available",sourceCode:"",sourceLine:1,sourceColumn:1}),e=this.lastSourceCodeState);const{sourceFile:n,sourceCode:s,sourceLine:r}=e;let i=this.files[n];i||(i={sourceCode:s,screenshots:{}},this.files[n]=i);let o=i.screenshots[r];o||(o=[],i.screenshots[r]=o),o.push({invocationIndex:++this.lastInvocationIndex,file:this.lastScreenshotName}),this.recodedTest.sourceFiles[n]||(this.recodedTest.sourceFiles[n]=s),this.recodedTest.slides.push({screenshot:this.lastScreenshotName,sourceFile:n,sourceLine:r}),this.sendScreenshotToPuppeteer()}sendScreenshotToPuppeteer(){return ee(this,void 0,void 0,(function*(){if(this.messageSentToPuppeteer=this.createMessageForPuppeteer(),this.master.slave.lastElementCaptured){const e=this.master.slave.lastElementCaptured.getBoundingClientRect();this.messageSentToPuppeteer.rect={x:e.x,y:e.y,width:e.width,height:e.height}}this.master.sendMessageToPuppeteer("waitingForNextStep",this.messageSentToPuppeteer)}))}createMessageForPuppeteer(){return{dir:this.master.slave.reporterFromSlaveToMaster.currentClass+"/"+this.master.slave.reporterFromSlaveToMaster.currentFunction,screenshotNumber:this.lastScreenshotNumber,fileWithoutExtension:this.lastScreenshotName}}onScreenshotSavedByPuppeteer(e){var t;if(this.messageSentToPuppeteer.dir!==e.dir||this.messageSentToPuppeteer.fileWithoutExtension!==e.fileWithoutExtension||this.messageSentToPuppeteer.screenshotNumber!==e.screenshotNumber)throw new Error(`Something went wrong. Puppeteer and the app are not in sync any more. Screenshot sent by the app to be saved = ${JSON.stringify(this.messageSentToPuppeteer,void 0," ")}. But puppeteer says it just saved = ${JSON.stringify(e,void 0," ")}`);this.master.slave.reporterFromSlaveToMaster.testFailed?(null===(t=this.resumeSendingReportToPuppeteerCallback)||void 0===t||t.call(this),this.messageSentToPuppeteer=void 0):this.master.nextStep()}waitForError(){if(this.waitForErrorPromise)throw new Error("Illegal! waitForError() was called, errorArrived() was NOT called, and then waitForError() was called again");this.waitForErrorPromise=new Promise((e=>this.waitForErrorPromiseResolve=e))}errorArrived(e){var t;this.recodedTest.error=e,null===(t=this.waitForErrorPromiseResolve)||void 0===t||t.call(this,e)}getError(){return ee(this,void 0,void 0,(function*(){return this.error||this.waitForErrorPromise||void 0}))}processComment(e){let t=e;return t=t.replace(/^\s*/,""),t=t.replace(/\s*$/,""),t.split(/\n/)}printMarkdown(e){var t,n;return ee(this,void 0,void 0,(function*(){const s=x.substringBefore(e,".",!0),r=x.substringAfter(e,".",!0),i=null===(t=this.master.state.testClassDescriptors)||void 0===t?void 0:t.find((e=>e.name===s)),o=null==i?void 0:i.functions.find((e=>e.functionName===r));let a=`\n# ${e}()\n\n### ${null==o?void 0:o.scenario}\n`;(null==o?void 0:o.comments)&&(a+="\n```\n",null===(n=null==o?void 0:o.comments)||void 0===n||n.forEach((e=>{this.processComment(e).forEach((e=>{a+=`// ${e.trim()}\n`}))})),a+="```\n"),a+="\n---\n";const l=yield this.getError();void 0!==l&&(a+=`\n## The following error was caught while running the test:\n\n\`\`\`\n${l}\n\`\`\`\n\n---\n\n`),a+=`\nThere are ${this.lastInvocationIndex} screenshots. [Go to first](#screenshot-1)\n`;for(let t in this.files){const n=this.files[t];a+=`\n## ${t}\n`;const s=Object.getOwnPropertyNames(n.screenshots).map((e=>parseInt(e)));s.sort(((e,t)=>e-t));const r=n.sourceCode.split("\n"),i=r.length.toString().length;r.forEach(((e,t)=>r[t]="/*"+(t+1).toString().padStart(i)+"*/"+e));let o=0;const l=s.length>0&&s[0];!1!==l&&l>this.visibleLinesForFirstAndLastChunk&&(o=l-this.visibleLinesForFirstAndLastChunk,a+=this.printChunk(e,r,0,o));for(let t of s)a+=this.printChunk(e,r,o,t,n.screenshots[t]),o=t;a+=this.printChunk(e,r,o,void 0)}return a}))}printChunk(e,t,n,s,r){let i=`${r?"":"\n<details><summary>Click to expand the hidden lines of code</summary>\n"}\n\`\`\`tsx\n${t.slice(n,s).join("\n")}\n\`\`\`\n${r?"":"\n</details>\n"}`;if(!r)return i;for(let o of r)i+=`\n<table><tr>\n<td>\n\n### Screenshot ${o.invocationIndex}\n\n${o.invocationIndex<=1?"":`[Go to previous](#screenshot-${o.invocationIndex-1})`}${o.invocationIndex<=1||o.invocationIndex>=this.lastInvocationIndex?"":" | "}${o.invocationIndex>=this.lastInvocationIndex?"":` [Go to next](#screenshot-${o.invocationIndex+1})`}\n\n<details><summary>Click to expand full image</summary>\n\n${e}/${o.file}.png <br/>\n![](${o.file}.png)\n\n</details>\n</td>\n<td>\n\n![](${o.file}_small.png)\n\n</td>\n</tr></table>\n`;return i}sendMarkdownToPuppeteer(){return ee(this,void 0,void 0,(function*(){let e;this.recodedTest.duration=(new Date).getTime()-this.creationTime;const t=()=>ee(this,void 0,void 0,(function*(){const t=this.master.slave.reporterFromSlaveToMaster.currentClass+"/"+this.master.slave.reporterFromSlaveToMaster.currentFunction;this.master.sendMessageToPuppeteer("writeMarkdownReport",{dir:t,markdown:yield this.printMarkdown(t),recordedTest:this.recodedTest}),this.resumeSendingReportToPuppeteerCallback=void 0,null==e||e.apply(null)}));if(this.messageSentToPuppeteer){if(this.master.slave.reporterFromSlaveToMaster.testFailed)return console.log("We want to print the Markdown report. But the call from puppeteer didn't return. So we'll wait, and then we'll continue w/ writing the report"),this.resumeSendingReportToPuppeteerCallback=t,new Promise((t=>e=t));throw new Error("There is no test failure (because of async code), a screenshot save is in progress, so why are we trying to send the report?")}yield t()}))}}var ne=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class se{constructor(e,t,n,s){this.componentName=e,this.id=t,this.functionName=n,this.args=s}getTestId(){return this.componentName+"_"+this.id+"_"+this.functionName}getGeneratedSourceCode(){var e;const t=null===(e=this.args)||void 0===e?void 0:e.map((e=>"string"==typeof e?'"'+e+'"':e)).join(",");return`await uiApi${this.componentName}(${this.id?this.id:""}).dispatcher.${this.functionName}(${t});`}}class re extends r.Component{static getKey(e,t){return e+"_"+t}componentDidMount(){re.listeners[re.getKey(this.props.componentName,this.props.id)]=this}componentWillUnmount(){delete re.listeners[re.getKey(this.props.componentName,this.props.id)]}render(){return null}}re.listeners={};class ie{constructor(e,t,n){this.uiApiHelper=e,this.componentName=t,this.id=n;const s=this;this.testids=new Proxy({},{get:(e,t,n)=>new se(s.componentName,s.id,t).getTestId()}),this.dispatcher=new Proxy({},{get(r,i,o){var a=this;return function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return ne(a,void 0,void 0,(function*(){const r=re.listeners[re.getKey(t,n)];if(!r)throw new Error("Trying to access UiApi, but listener is not mounted for: "+re.getKey(t,n));console.debug("UiApi",t,n,i,o);const a=new se(t,n,i,o);(yield e.onBeforeCallImplementation(void 0!==s._Listener,a))&&r.props.implementation[i].apply(r,o)}))}}})}get Listener(){return this._Listener||(this._Listener=e=>(0,s.jsx)(re,{componentName:this.componentName,id:this.id,implementation:e.implementation},void 0)),this._Listener}}var oe=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class ae{static get INSTANCE(){if(window.testsAreDemoMaster)throw new Error("UiApis should only exist in TADSlave. Trying to access it from TADMaster.");return ae._INSTANCE||(ae._INSTANCE=new ae),ae._INSTANCE}create(e){return t=>new ie(this,e,t=t||"")}onBeforeCallImplementation(e,t){return oe(this,void 0,void 0,(function*(){if(!de._INSTANCE)return!0;let n;try{n=(0,R.getByTestId)(document.body,t.getTestId())}catch(s){const e=s+`\n\nThe component that emitted the event: does it have e.g. \ndata-testid={api.testids.${t.functionName}}\n?`;throw alert(e),s}if(de.INSTANCE.master.state.running)e||(de.INSTANCE.lastElementCaptured=n,yield be.showSpotlight({focusOnLastElementCaptured:!0,message:t.getTestId()}));else if(de.INSTANCE.master.refCaptureUiApiEvents.current)return yield de.INSTANCE.master.refCaptureUiApiEvents.current.onCapture(n,t.getGeneratedSourceCode());return!0}))}}var le,ce=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};!function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE",e[e.HIDE_NEXT=2]="HIDE_NEXT"}(le||(le={}));class de extends r.Component{constructor(e){super(e),this.state={},this.uiApiHelper=ae.INSTANCE,this.stepByStep=!1,this.runRequestedWhileMochaInitializing=!1,this.onlyCalled=!1,this.onlyUntilCalled=!1,this.demoForEndUser=le.SHOW,this.onDocumentMouseMove=this.onDocumentMouseMove.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this)}setLastElementCaptured(e){this.lastElementCaptured=e}componentDidMount(){var e,t,n;return ce(this,void 0,void 0,(function*(){if(de._INSTANCE)throw new Error("Cannot create more than one instances of TestsAreDemoSlave");if(de._INSTANCE=this,!(null===(e=window.parent)||void 0===e?void 0:e.testsAreDemoMaster))throw new Error("Looking at the parent of this IFrame to find TestsAreDemoMaster. But was not found.");this.master=window.parent.testsAreDemoMaster,this.master.slave=this;je((null===(n=(t=this.props).createTestsAreDemoFunctions)||void 0===n?void 0:n.call(t))||new xe),this.initMocha()}))}initMocha(){return ce(this,void 0,void 0,(function*(){window.process||(window.process={browser:!0}),window.Buffer||(window.Buffer={isBuffer:()=>!1}),yield Promise.all([n.e(600),n.e(658)]).then(n.t.bind(n,65600,23)),mocha.setup({ui:"bdd",timeout:1e6});const e=this;mocha.reporter(class extends Mocha.reporters.Base{constructor(t,n){super(t,n),e.reporterFromSlaveToMaster=e.master.onMochaReporterCreated(this,t,n)}}),mocha.cleanReferencesAfterRun(!1),this.monkeyPatchMocha(),beforeEach((()=>{this.onlyUntilCalled=!1,this.demoForEndUser=le.SHOW,this.report=new te(this.master)})),afterEach((()=>ce(this,void 0,void 0,(function*(){yield this.report.sendMarkdownToPuppeteer()})))),de.mochaInitialized=!0,yield this.props.importTestsCallback(),Z().use(X()),this.runRequestedWhileMochaInitializing&&this.run(),Error.stackTraceLimit=1/0}))}monkeyPatchMocha(){var e=this;const t=globalThis.it;if(t.onlyUntil)throw new Error("'it' already monkeypatched");const n=function(){if(e.onlyUntilCalled)return null;for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return t.apply(null,s)};globalThis.it=n,n.only=t.only,n.skip=t.skip,n.retries=t.retries,n.onlyUntil=function(){if(!e.onlyCalled)throw new Error("'it.onlyUntil()' detected, but the parent suite should be 'describe.only()'");for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];const i=n.apply(null,s);return e.onlyUntilCalled=!0,i};const s=globalThis.describe,r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(null,t)};globalThis.describe=r,r.skip=s.skip,r.only=function(){e.onlyCalled=!0;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s.only.apply(null,n)}}getMochaConstants(){return Mocha.Runner.constants}getTestsAreDemoFunctions(){return be}static get INSTANCE(){if(!de._INSTANCE)throw new Error("There is no TestsAreDemoSlave singleton available. This might happen if somehow you run tests that are NOT in the IFrame of TestsAreDemoMaster (i.e. in TestsAreDemoSlave)");return de._INSTANCE}run(){return ce(this,void 0,void 0,(function*(){if(!de.mochaInitialized)return void(this.runRequestedWhileMochaInitializing=!0);mocha.suite.suites=[];const e=be.addTestsFromDescriptors(this.master.state.testClassDescriptors,this.master.state.testsToRun,this.master.props.puppeteer);this.master.props.puppeteer&&(yield this.master.puppeteerBridge.sendMessageToPuppeteer("writeFile",{path:"testClassDescriptors.json",content:JSON.stringify(e)})),mocha.run((()=>{this.master.setState({running:!1}),this.master.readStepByStep()})).addListener("suite",(()=>{}))}))}showSpotlight(e,t){return ce(this,void 0,void 0,(function*(){let n;try{const e=Error.stackTraceLimit;let t;Error.stackTraceLimit=1/0;try{t=O().parse(new Error)}finally{Error.stackTraceLimit=e}for(let s of t)if(s.getFileName()&&s.getLineNumber()&&s.getColumnNumber()&&(n=yield k.INSTANCE.getSourceCodeState(s.getFileName(),s.getLineNumber(),s.getColumnNumber()),n&&(n.sourceFile.includes("TestsAreDemo.")||n.sourceFile.includes("TestsAreDemoInner.")))){this.master.setState({sourceCodeInfo:n});break}}catch(s){console.error("Error caught while trying to process the source map.",s)}this.master.enableNextStepButton(t),this.setState({spotlightParams:e}),this.report.onShowSpotlight(n,this.lastElementCaptured)}))}hideSpotlight(){return ce(this,void 0,void 0,(function*(){be.miniDb.removeHighlight(),this.setState({spotlightParams:void 0})}))}enableStepByStepProgrammatically(){if(this.master.state.stepByStepMode===$t.OFF)throw new Error("You are calling 'enableStepByStepProgrammatically()', but 'Step by step' is not 'Controlled by program'. This function is meant to be used temporarily; maybe you forgot to remove it?");this.currentComment=null,this.stepByStep=!0}onDocumentMouseMove(e){let t=e.target,n=[];for(;t;){t.getAttribute(this.master.testIdProp)&&n.push(t),t=t.parentElement}0===n.length?(this.setState({inspectedElement:void 0}),n=void 0):this.setState({inspectedElement:n[0]}),this.master.setState({inspectedElements:n})}onDocumentClick(){this.toggleInspect()}toggleInspect(){this.master.state.inspecting?(document.removeEventListener("mousemove",this.onDocumentMouseMove),document.removeEventListener("click",this.onDocumentClick)):(document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("click",this.onDocumentClick)),this.setState({inspectedElement:void 0}),this.master.setState({inspecting:!this.master.state.inspecting})}renderSpotlight(e,t){void 0===t&&(t="");return e.x-=5,e.y-=5,e.width+=10,e.height+=10,(0,s.jsx)("div",{className:"TestsAreDemo_spotlight "+t,style:{left:`${e.x}px`,top:`${e.y}px`,width:`${e.width}px`,height:`${e.height}px`}},void 0)}renderFloater(e,t){return(0,s.jsx)(Y.Z,{content:t,open:!0,styles:{options:{zIndex:10001},container:{borderRadius:"4px"},floater:{maxWidth:"800px"}},target:e},void 0)}render(){const e=(0,s.jsx)(he,{tads:this,spotlightParams:this.state.spotlightParams},void 0);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{id:"rtl",className:"flex-container flex-grow"},void 0),(0,s.jsx)("div",{id:"mocha"},void 0),this.state.spotlightParams&&this.lastElementCaptured&&this.state.spotlightParams.focusOnLastElementCaptured&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",Object.assign({className:"TestsAreDemo_overlay"},{children:[this.renderSpotlight(this.lastElementCaptured.getBoundingClientRect()),(0,s.jsxs)("div",Object.assign({className:"TestsAreDemo_screenshotPath"},{children:["Screenshot dir/file: ",this.reporterFromSlaveToMaster.currentClass,"/",this.reporterFromSlaveToMaster.currentFunction,"/",this.report.lastScreenshotName]}),void 0)]}),void 0),!this.master.props.forceStepByStep&&this.renderFloater(this.lastElementCaptured,e)]},void 0),this.state.spotlightParams&&(!this.lastElementCaptured||!this.state.spotlightParams.focusOnLastElementCaptured)&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(g.Z,Object.assign({open:!0},{children:(0,s.jsx)(g.Z.Content,{children:e},void 0)}),void 0)},void 0),this.state.inspectedElement&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",Object.assign({className:"TestsAreDemo_overlay"},{children:this.renderSpotlight(this.state.inspectedElement.getBoundingClientRect())}),void 0),this.state.inspectedElementPopup&&this.renderFloater(this.state.inspectedElement,this.state.inspectedElementPopup)]},void 0)]},void 0)}}function he(e){let{tads:t,spotlightParams:n}=e;const[i,o]=(0,r.useState)(null),[a,l]=(0,r.useState)(void 0);(0,r.useEffect)((()=>{"string"==typeof t.currentComment?o((0,s.jsx)(N,{children:t.currentComment},void 0)):o(t.currentComment),l(t.currentCommentSlideIndex),t.currentComment=void 0,t.currentCommentSlideIndex=void 0}),[]);let c=null==n?void 0:n.message;const d=!!c;return"string"==typeof c&&(c=(0,s.jsx)(N,{children:c},void 0)),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{circular:!0,color:"brown",content:t.report.lastScreenshotNumber},void 0),c,i&&(0,s.jsxs)(s.Fragment,{children:[d&&(0,s.jsx)(m.Z,{},void 0),(0,s.jsx)("p",{},void 0),i]},void 0)]},void 0)}de.mochaInitialized=!1;var ue=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class pe{constructor(){this.data={}}addRow(e,t,n){let s=this.data[e];s||(this.data[e]=s={}),s[t]=n}clear(){return this.data={},this.highlighted=void 0,this}populate(e){return ue(this,void 0,void 0,(function*(){throw new Error("Not implemented. Please create a subclass and implement this function according to your server backend/DB.")}))}get(e,t,n){var s;const r=this.data[e];if(!r)throw new Error("Cannot find entityName: "+e);const i=r[t];if(!i)throw new Error(`For entityName = ${e}, cannot find row w/ id = ${t}`);return this.highlighted={entityName:e,id:t,field:n},null===(s=de.INSTANCE.master.refMiniDbTableSetComponent.current)||void 0===s||s.forceUpdate(),i[n]}getDerived(e,t,n,s){const r=this.get(e,t,n);return"function"==typeof s?s.call(null,r):s}removeHighlight(){var e;this.highlighted=void 0,null===(e=de.INSTANCE.master.refMiniDbTableSetComponent.current)||void 0===e||e.forceUpdate()}}const me=e=>{let{children:t}=e;return(0,s.jsx)(s.Fragment,{children:t},void 0)};(0,R.configure)({getElementError:e=>new Error(e||"n/a")});const ve=/{s([0-9]+(?:\.[0-9]+)?)+}/;class ge{constructor(e){var t;if(this.lastSlideIndex=null,this.nextSlideIndex=null,this.text=e,!(null===(t=window.parent)||void 0===t?void 0:t.testsAreDemoMaster))throw new Error("Looking at the parent of this IFrame to find TestsAreDemoMaster. But was not found.");this.master=window.parent.testsAreDemoMaster}slide(e){if(!this.master.state.stepByStepMode)return;if(!this.nextSlideIndex){let e=this.text.match(ve);if(!e)throw new Error("Could not find any slides.");this.nextSlideIndex=Number(e[1]).valueOf(),this.text=this.splitTextBySlidePattern(e)[1]}if(e!==this.nextSlideIndex)throw this.text.match(`{s${e}`)||e===this.lastSlideIndex?new Error(`Last accesed slide: ${this.lastSlideIndex}. You should be now accesing slide: ${this.nextSlideIndex}. But you are accesing slide: ${e}.`):new Error(`You are trying to access slide: ${e}, but it does not exist.`);let t=this.text.match(ve);if(!t)return void this.updateSlideProperties(this.text,this.nextSlideIndex,"",-1);const n=Number(t[1]).valueOf();if(n<this.nextSlideIndex)throw new Error(`You are trying to access slide: ${e}. But we have found slide ${n} after slide ${e}. The slides should be in ascending order.`);let s=this.splitTextBySlidePattern(t);this.updateSlideProperties(s[0],this.nextSlideIndex,s[1],n)}splitTextBySlidePattern(e){const t=this.text.split(e[0]);if(t.length>2)throw new Error(`Slide ${e[1]} appears multiple times.`);return t}updateSlideProperties(e,t,n,s){de.INSTANCE.currentComment=e,de.INSTANCE.currentCommentSlideIndex=this.lastSlideIndex=t,this.text=n,this.nextSlideIndex=s}}var fe=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const Se=".<group>";class xe{constructor(){this.waitForWhileException=R.waitFor,this.elementToObjectViaShortcutRefForTest=new Map,this.miniDb=new pe,this.nextTimeout=300;const e=this;this.createWrapperForDomSelectorFunction=this.createWrapperForDomSelectorFunction.bind(this),this.screenCapturing=this.iterateAndReplaceFunctions(Object.assign({},R.screen),this.createWrapperForDomSelectorFunction),this.assertWaitable=this.iterateAndReplaceFunctions(Object.assign({},L.assert),((t,n)=>function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fe(this,void 0,void 0,(function*(){let r=i[1];"object"==typeof r&&(r="Object ("+r.constructor.name+"): "+x.consoleLogJson(i[1],!1)),yield e.showSpotlight({focusOnLastElementCaptured:!0,message:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{color:"green",content:"Testing"},void 0),(0,s.jsx)(h.Z,{content:t},void 0),r&&(0,s.jsx)(h.Z,{content:r},void 0)]},void 0)}),n.apply(null,i)}))})),this.createWrapperForActionFunction=this.createWrapperForActionFunction.bind(this),this.userEventWaitable=this.iterateAndReplaceFunctions(Object.assign({},M.ZP),this.createWrapperForActionFunction),this.fireEventWaitable=this.iterateAndReplaceFunctions(Object.assign({},R.fireEvent),this.createWrapperForActionFunction),this.drag=this.createWrapperForActionFunction("drag",K)}getTestsAreDemoSlave(){return x.isTest()?void 0:de.INSTANCE}iterateAndReplaceFunctions(e,t,n){for(const s in e){if(n&&!n(s))continue;const r=t(s,e[s]);r&&(e[s]=r)}return e}createWrapperForActionFunction(e,t,n){void 0===n&&(n=null);const r=this;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];let l="";"type"===e&&(l=o[1]);const c=r.showSpotlight({focusOnLastElementCaptured:!0,message:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{color:"blue",content:"Will perform action"},void 0),(0,s.jsx)(h.Z,{content:e},void 0),l&&(0,s.jsx)(h.Z,{content:l},void 0)]},void 0)});if(!c)return t.apply(n,o);const d=new Promise((e=>{c.then((()=>{const s=t.apply(n,o);s instanceof Promise?s.then((t=>e(t))):e(c)}))}));return"type"!==e?d:new Promise((e=>d.then((t=>{var n;return null===(n=r.showSpotlight({focusOnLastElementCaptured:!0,message:"was typed"+l}))||void 0===n?void 0:n.then((()=>e(t)))}))))}}createWrapperForDomSelectorFunction(e,t){if(!this.getTestsAreDemoSlave())return t;const n=this;return e.startsWith("get")||e.startsWith("query")?function(){for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];const i=t.apply(null,s);let o=i;return Array.isArray(i)&&(o=i[0]),n.getTestsAreDemoSlave().setLastElementCaptured(o),i}:e.startsWith("find")?function(){for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];const i=t.apply(null,s);return i.then((e=>{let t=e;return Array.isArray(e)&&(t=e[0]),n.getTestsAreDemoSlave().setLastElementCaptured(t),t})),i}:null}withinCapturing(e,t){const n=(0,R.within)(e,t);return this.iterateAndReplaceFunctions(Object.assign({},n),this.createWrapperForDomSelectorFunction)}showSpotlight(e){var t;if(null===(t=this.getTestsAreDemoSlave())||void 0===t?void 0:t.stepByStep){if(this.getTestsAreDemoSlave().master.state.endUser){if(this.getTestsAreDemoSlave().demoForEndUser===le.HIDE)return;if(this.getTestsAreDemoSlave().demoForEndUser===le.HIDE_NEXT)return void this.demoForEndUserShow()}return"string"==typeof e&&(e={message:e}),e||(e={message:"",focusOnLastElementCaptured:!0}),new Promise((t=>this.getTestsAreDemoSlave().showSpotlight(e,t)))}}waitForWhile(e,t){return fe(this,void 0,void 0,(function*(){(t=t||{}).interval=t.interval||50,t.timeout=t.timeout||2e3;const n=Date.now();for(;yield e();)if(yield x.setTimeoutPromise((()=>null),t.interval),Date.now()-n>t.timeout)throw new Error("Timeout after having waited "+t.timeout+"ms and having retried each "+t.interval+"ms")}))}waitForCommunicationFinishedNextTimeoutTemp(e){this.nextTimeout=e}waitForCommunicationFinished(e){return fe(this,void 0,void 0,(function*(){yield x.setTimeoutPromise(void 0,this.nextTimeout),this.nextTimeout=300}))}enableStepByStep(){var e;null===(e=this.getTestsAreDemoSlave())||void 0===e||e.enableStepByStepProgrammatically()}getObjectViaCheat(e,t,n){var s;t instanceof HTMLElement&&(n=t,t=void 0);const r=_.INSTANCE.getClassName(e)+(t?"_"+t:""),i=(0,R.getByTestId)(n||document.body,r);return null===(s=this.getTestsAreDemoSlave())||void 0===s||s.setLastElementCaptured(i.parentElement),i.testsAreDemoCheat}getObjectViaCheatWaitable(e,t,n,s){const r=this.getObjectViaCheat(e,n,s),i=this;return new Proxy(r,{get:(e,n,s)=>i.createWrapperForActionFunction(t,e[n],e)})}getObjectViaShortcutRefForTestWaitable(e,t){var n;const s=_.INSTANCE.getClassName(e)+(t?"_"+t:""),r=(0,R.getByTestId)(document.body,s);null===(n=this.getTestsAreDemoSlave())||void 0===n||n.setLastElementCaptured(r);let i=this.elementToObjectViaShortcutRefForTest.get(r);return i||(i=this.iterateAndReplaceFunctions(r.testsAreDemoCheat,this.createWrapperForActionFunction,(e=>e.startsWith("tad"))),this.elementToObjectViaShortcutRefForTest.set(r,i)),i}wrapWithPropsSetter(e,t){let n={Component:()=>{const[i,o]=(0,r.useState)(e);return n.setProps=o,(0,s.jsx)(s.Fragment,{children:t(i)},void 0)},setProps:null};return n}renderWrappedWithPropsSetter(e,t,n){const r=be.wrapWithPropsSetter(e,t);return Object.assign(Object.assign({},function(e,t){const n=document.getElementById("rtl");return(0,R.render)(e,Object.assign({wrapper:me,container:n},t))}((0,s.jsx)(r.Component,{},void 0),n)),{setProps:r.setProps})}currentComment(e){this.getTestsAreDemoSlave()&&(this.getTestsAreDemoSlave().currentComment=e,this.getTestsAreDemoSlave().currentCommentSlideIndex=void 0)}cc(e){this.currentComment(e)}loadSlides(e){return fe(this,void 0,void 0,(function*(){const t=yield fetch(e);this.slides=new ge(yield t.text())}))}currentSlide(e){if(!this.slides)throw new Error("Slides not loaded. Use 'loadSlides()'.");this.slides.slide(e)}cs(e){this.currentSlide(e)}demoForEndUserHide(){this.getTestsAreDemoSlave()&&(this.getTestsAreDemoSlave().demoForEndUser=le.HIDE,this.getTestsAreDemoSlave().demoForEndUserSavedCurrentCommentBeforeHide=this.getTestsAreDemoSlave().currentComment)}demoForEndUserHideNext(){this.getTestsAreDemoSlave()&&(this.getTestsAreDemoSlave().demoForEndUser=le.HIDE_NEXT,this.getTestsAreDemoSlave().demoForEndUserSavedCurrentCommentBeforeHide=this.getTestsAreDemoSlave().currentComment)}demoForEndUserShow(){this.getTestsAreDemoSlave()&&(this.getTestsAreDemoSlave().demoForEndUser=le.SHOW,this.getTestsAreDemoSlave().currentComment=this.getTestsAreDemoSlave().demoForEndUserSavedCurrentCommentBeforeHide,this.getTestsAreDemoSlave().demoForEndUserSavedCurrentCommentBeforeHide=null)}addTests(){var e;const t=[];for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];for(let i of s)this.createTestClassDescriptor(t,void 0,i);null===(e=this.getTestsAreDemoSlave())||void 0===e||e.master.setState({testClassDescriptors:t})}createTestClassDescriptor(e,t,n){var s;const r=t?t+"."+n.name:n.name,i={testClass:n,name:r,functions:[],hooks:[]};e.push(i);const o=new n,a=Object.getPrototypeOf(o),l=W(a),c=Object.getOwnPropertyNames(a);let d,h=[];for(let u=0;u<c.length;u++){const e=c[u];if("function"!=typeof o[e]||"constructor"===e)continue;const t=o[e];if("annotation"===e){z(a,U),t.apply(o);continue}if(e.startsWith("annotation")){d=t;continue}if("before"===e||"after"===e||"beforeEach"===e||"afterEach"===e){i.hooks.push(e);continue}d&&(z(a,e),d.apply(o));const n=l[e];e.startsWith("group")?h.push(e):n&&void 0!==n.scenario&&i.functions.push({functionName:e,scenario:n.scenario,comments:n.comments})}z(void 0,void 0),i.comments=null===(s=l[U])||void 0===s?void 0:s.comments;for(let u of h)this.createTestClassDescriptor(e,r,o[u]())}addTestsFromDescriptors(e,t,n){const s=[],r=n&&!t;if(e&&(r||t)){for(let n of e)(r||t[n.name]&&0!==Object.getOwnPropertyNames(t[n.name]).length)&&describe(n.name,(()=>{const e=Object.assign(Object.assign({},n),{functions:[]});s.push(e);const i=new n.testClass;for(let t of n.hooks){const e=i[t].bind(i);if("before"===t)before(e);else if("after"===t)after(e);else if("beforeEach"===t)beforeEach(e);else{if("afterEach"!==t)throw new Error("Unexpected hook: "+t);afterEach(e)}}for(let s of n.functions){if(!r&&!t[n.name][s.functionName])continue;e.functions.push(s);const o=i[s.functionName].bind(i);it(s.functionName,o)}}));return s}}getFunctionsThatNeedOnly(e,t){var n,s,r,i;const o=new Array(t.length),a=new Array(t.length);let l=!1;for(let d=0;d<t.length;d++){const i=null==e?void 0:e[t[d]];((null===(n=null==i?void 0:i.options)||void 0===n?void 0:n.runOnlyThisScenario)||l)&&(o[d]=!0,l=null===(s=null==i?void 0:i.options)||void 0===s?void 0:s.linkWithNextScenario),d<t.length-1&&(a[d+1]=null===(r=null==i?void 0:i.options)||void 0===r?void 0:r.linkWithNextScenario)}let c=!1;for(let d=t.length-1;d>=0;d--){const n=null==e?void 0:e[t[d]];((null===(i=null==n?void 0:n.options)||void 0===i?void 0:i.runOnlyThisScenario)||c)&&(o[d]=!0,c=a[d])}return o}}let be;function je(e){if(window.testsAreDemoMaster){be=new Proxy({},{get(e,t,n){throw new Error("Attempting to use 'tad' outside the slave IFrame (which runs the test). Please review the stack trace to understand who's doing this illegal call.")}})}else be=e}function we(e,t){for(let n in t)t[n]=e+"_"+n;return t}var Ce=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class Te{constructor(e,t,n,s){this.master=e,this.reporter=t,this.runner=n,this.options=s,this._indents=0,this.testFailed=!1,this.currentClass="",this.currentFunction="",this.onTestFail=this.onTestFail.bind(this),this.onEnd=this.onEnd.bind(this);const{EVENT_RUN_BEGIN:r,EVENT_RUN_END:i,EVENT_TEST_FAIL:o,EVENT_TEST_PASS:a,EVENT_SUITE_BEGIN:l,EVENT_SUITE_END:c,EVENT_TEST_BEGIN:d,EVENT_TEST_END:h}=this.master.slave.getMochaConstants();n.once(r,(()=>{this.log("start")})).on(l,(e=>{this.currentClass=x.substringBefore(e.title,Se),this.increaseIndent(e.title),this.log(this.indent()+"[suite] "+e.title)})).on(c,(()=>{this.decreaseIndent()})).on(d,(e=>{this.currentFunction=e.title,this.testFailed=!1,this.increaseIndent(e.title),this.log(this.indent()+"[test begin] "+e.title)})).on(h,(()=>{this.decreaseIndent()})).on(a,(e=>{this.log(`${this.indent()}[test passed] ${e.title}`)})).on(o,this.onTestFail).once(i,this.onEnd)}indent(){return Array(this._indents).join("  ")}getDirFromPath(e){let t="";return e.length>=1&&(t=e[e.length-1]),e.length>=2&&(e[e.length-2].startsWith(Se)?e.length>=3&&(t=e[e.length-3]+"."+t):t=e[e.length-2]+"."+t),t}increaseIndent(e){this._indents++}decreaseIndent(){this._indents--}consoleLog(e){console.log(e)}log(e){this.consoleLog(e),this.master.log(e)}onTestFail(e,t){return Ce(this,void 0,void 0,(function*(){if(this.testFailed=!0,this.log(`${this.indent()}[test failed] (**look in the console for the clickable stacktrace**): ${e.title}. Error = ${t}`),this.consoleLog("Test '"+e.title+"' has failed w/ the following error (should have clickable stacktrace):"),console.log("*** Printing error w/ the old method"),this.consoleLog(t),"Error"!==Object.getPrototypeOf(t).name){const e=new Error;e.stack=t.stack,console.log("Printing the error again, to make sure we have a clickable stacktrace:"),console.log(e)}console.log("*** Printing the error w/ the new method (decoding the stack trace via source maps)");const n=this.master.slave.report;n.waitForError();const s=yield k.INSTANCE.decodeStackTrace(t);this.consoleLog(s),n.errorArrived(s)}))}onEnd(){const e=this.runner.stats;this.log(`end: ${e.passes}/${e.passes+e.failures} ok`),this.master.props.puppeteer&&this.master.sendMessageToPuppeteer("finished",this.runner.stats)}}var ye=n(92589),Ee=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};const Ne="currentLine",Ie="code",De=we("TestsAreDemoMaster",{line:"",code:""});class Oe extends r.Component{adjustScrollbarsIfNeededToHaveCurrentLineElementInViewport(){const e=document.getElementById(Ne);if(!e)return;const t=document.getElementById(Ie);var n=t.scrollTop,s=n+t.offsetHeight;let r=t.offsetHeight-t.clientHeight;var i=e.offsetTop,o=i+e.offsetHeight+r;(n>i||s<o)&&e.scrollIntoView()}componentDidUpdate(e){this.props.sourceCodeInfo&&e.sourceCodeInfo!=this.props.sourceCodeInfo&&this.adjustScrollbarsIfNeededToHaveCurrentLineElementInViewport()}render(){var e;const t=this.props.sourceCodeInfo;return(null==t?void 0:t.sourceCode)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["File@line: ",(0,s.jsx)("b",{children:x.substringAfter(t.sourceFile,"/",!0)},void 0),"@",t.sourceLine," \xa0",(0,s.jsx)(d.Z,{trigger:(0,s.jsx)(a.Z,{icon:"bars",size:"mini"},void 0),flowing:!0,on:"click",pinned:!0,content:(0,s.jsxs)(s.Fragment,{children:["Full file name: ",(0,s.jsx)("b",{children:null===(e=t.sourceFile)||void 0===e?void 0:e.split("..").pop()},void 0),(0,s.jsx)("p",{},void 0),(0,s.jsx)(a.Z,{size:"mini",content:"Print it to console",onClick:()=>{var e;console.log("Printing the file name, in a clickable form:"),t.sourceFile?console.log(window.location.origin+(null===(e=t.sourceFile)||void 0===e?void 0:e.split("..").pop())+":"+t.sourceLine):console.log("The source file is undefined")}},void 0),"Then open DevTools (e.g. via ",(0,s.jsx)(h.Z,{size:"mini",content:"F12"},void 0),") and click on the file name (to open it in DevTools)."]},void 0)},void 0)]},void 0),(0,s.jsx)(Fe,Object.assign({highlightSourceLine:t.sourceLine},{children:t.sourceCode}),void 0)]},void 0):(0,s.jsx)(s.Fragment,{children:"SourceCode not yet loaded"},void 0)}}function Fe(e){const{highlightSourceLine:t}=e,n=Ee(e,["highlightSourceLine"]);return(0,s.jsx)(y.Z,Object.assign({id:"SyntaxHighlighter",className:"no-padding-margin flex-container flex-grow",codeTagProps:{"data-testid":De.code,id:Ie,className:"language-javascript flex-grow"},language:"javascript",style:ye.Z,wrapLines:!0,showLineNumbers:!0,lineProps:e=>{let n={background:e===t?"#dbffdb":"#0000"};return{"data-testid":De.line+"_"+e,style:n,id:e===t?Ne:void 0}}},n),void 0)}const Pe=e=>{var t;const[n,i]=(0,r.useState)(-1),[a,l]=(0,r.useState)(-1),c=t=>{if(e.getIdForLocalStorage)return e.getIdForLocalStorage(t);if("string"==typeof t)return t;throw new Error("item is not string; please provide getIdForLocalStorage")},d=function(t,n,s){void 0===s&&(s=!1),l(n),e.onSelect(t),!s&&e.localStorageKey&&localStorage.setItem(e.localStorageKey,c(t))};return(0,r.useEffect)((()=>{var t;if(e.items&&e.localStorageKey){const n=e.selectedImposed||localStorage.getItem(e.localStorageKey);if(!n)return;for(let s=0;s<(null===(t=e.items)||void 0===t?void 0:t.length);s++)if(n===c(e.items[s]))return void d(e.items[s],s,!0)}}),[e.items]),(0,s.jsx)(o.Z.Group,{children:null===(t=e.items)||void 0===t?void 0:t.map(((t,r)=>(0,s.jsx)(o.Z,Object.assign({secondary:r===n,tertiary:r===a,onMouseEnter:()=>i(r),onMouseLeave:()=>i(-1),onClick:()=>d(t,r)},{children:e.renderItem(t)}),r)))},void 0)},Ae="recordedTests/";const ke={MESSAGE_FOR_PUPPETEER:"MESSAGE_FOR_PUPPETEER",RECORDED_TESTS_INDEX:"recordedTestsIndex.json",RECORDED_TESTS_DIR:Ae,generateMarkdownDoc:async function(e){let t="";const n=[[]];let s,r=0;for(s of e.cells)n[n.length-1].push(s),r++,(r>=4||s.newLineAfter)&&(n.push([]),r=0);let i,o=0;for(i of n){for(s of(t+="<table>\n<tr>\n",i))t+=`<th>Fig. ${++o}</th>\n`;for(s of(t+="</tr>\n<tr>\n",i))t+=`<td>\n<div align="center">\n<details><summary>Click to expand full image</summary>\n\n![](${Ae}${s.image})\n\n</details>\n\n![](${Ae}${s.image.replace(".png","_small.png")})\n\n<br />\n\n${s.text}\n\n</div>\n</td>\n`;t+="</tr>\n</table>\n"}return t}};var Re=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const{generateMarkdownDoc:Me}=ke;class Le extends r.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){return Re(this,void 0,void 0,(function*(){const e=yield fetch("docDescriptors/index.json");if(!e.ok)return;const t=yield e.text();this.setState({descriptors:JSON.parse(t)})}))}loadDescriptor(e){return Re(this,void 0,void 0,(function*(){try{const t=yield fetch("docDescriptors/"+e);if(!t.ok)throw new Error;const n=yield t.text(),s=JSON.parse(n);this.setState({markdown:yield Me(s)})}catch(t){this.setState({markdown:void 0})}}))}render(){return(0,s.jsxs)(S,Object.assign({size:"25%",split:"vertical"},{children:[(0,s.jsx)("div",Object.assign({className:"w100"},{children:(0,s.jsx)(Pe,{items:this.state.descriptors,localStorageKey:nn,renderItem:e=>e,onSelect:e=>this.loadDescriptor(e)},void 0)}),void 0),(0,s.jsx)(N,{children:this.state.markdown},void 0),";"]}),void 0)}}var Ze=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const{RECORDED_TESTS_INDEX:_e,RECORDED_TESTS_DIR:Ue}=ke;class Be extends r.Component{constructor(){super(...arguments),this.state={}}componentDidMount(){return Ze(this,void 0,void 0,(function*(){const e=yield fetch(Ue+_e);if(!e.ok)return;const t=yield e.text();this.setState({dirs:JSON.parse(t)})}))}loadDir(e){return Ze(this,void 0,void 0,(function*(){try{const t=yield fetch(Ue+e+"/report.md");if(!t.ok)throw new Error;const n=yield t.text();this.setState({currentDir:e,markdown:n})}catch(t){this.setState({markdown:void 0})}}))}render(){return(0,s.jsxs)(S,Object.assign({size:"25%",split:"vertical"},{children:[(0,s.jsx)("div",Object.assign({className:"w100"},{children:(0,s.jsx)(Pe,{items:this.state.dirs,localStorageKey:sn,onSelect:e=>this.loadDir(e),renderItem:e=>(0,s.jsx)(s.Fragment,{children:e},void 0)},void 0)}),void 0),(0,s.jsx)(N,Object.assign({baseUrlForImages:Ue+this.state.currentDir},{children:this.state.markdown}),void 0),";"]}),void 0)}}var $e=n(92175),ze=n(11671),We=n(9115),He=n.n(We),Je=n(50072),Ve=n(69122);class Ge extends r.Component{constructor(e){super(e);const t={currentSlide:0};this.state=t,t.currentSlide=e.currentSlide||0}renderComponent(){let e,t;const{recordedTest:n}=this.props;if(n&&n.slides.length>0){const s=n.slides[this.state.currentSlide];e={sourceCode:n.sourceFiles[s.sourceFile],sourceFile:s.sourceFile,sourceLine:s.sourceLine,sourceColumn:0},t=this.props.testPath+"/"+n.slides[this.state.currentSlide].screenshot+".png"}return(0,s.jsxs)("div",Object.assign({className:"RecordedTestModal"},{children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(a.Z.Group,Object.assign({basic:!0},{children:[(0,s.jsx)(a.Z,{icon:"step backward",disabled:this.state.currentSlide<=0,onClick:()=>this.setState({currentSlide:this.state.currentSlide-1})},void 0),(0,s.jsx)(a.Z,{icon:"step forward",disabled:this.state.currentSlide>=n.slides.length-1,onClick:()=>this.setState({currentSlide:this.state.currentSlide+1})},void 0)]}),void 0),n&&n.slides.map(((e,t)=>(0,s.jsx)(h.Z,{as:"a",circular:!0,content:t+1,color:t===this.state.currentSlide?"blue":void 0,size:t===this.state.currentSlide?"huge":void 0,onClick:()=>this.setState({currentSlide:t})},t)))]},void 0),n&&(0,s.jsxs)(S,Object.assign({size:"25%",split:"vertical"},{children:[(0,s.jsx)("div",Object.assign({className:"flex-grow flex-container no-padding-margin"},{children:(0,s.jsx)(Oe,{sourceCodeInfo:e},void 0)}),void 0),(0,s.jsx)("div",{children:(0,s.jsx)("img",{src:t},void 0)},void 0)]}),void 0)]}),void 0)}render(){return(0,s.jsxs)(g.Z,Object.assign({className:"RecordedTestModalRoot",open:!0,size:"fullscreen",onClose:this.props.onClose},{children:[(0,s.jsx)(ot,Object.assign({},this.props,{parent:void 0,testFunctionDescriptor:this.props.parent.props.testFunctionDescriptor,recordedTest:this.props.recordedTest,additionalForSegment2:(0,s.jsxs)(s.Fragment,{children:["Recorded test URL: ",this.props.testPath]},void 0)}),void 0),this.renderComponent(),(0,s.jsx)(g.Z.Actions,{children:(0,s.jsx)(a.Z,Object.assign({onClick:this.props.onClose},{children:"Close"}),void 0)},void 0)]}),void 0)}}var qe=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};function Ke(e){let t=0,n=0;if(e)for(let s of Object.values(e)){const e=Object.getOwnPropertyNames(s).length;0!==e&&(t++,n+=e)}return{classesChecked:t,functionsChecked:n}}function Qe(e){const t=Ke(e);return`${t.functionsChecked}t (${t.classesChecked}c)`}function Xe(e){let t=0,n=0;return null==e||e.forEach((e=>{t++,n+=e.functions.length})),`${n}t (${t}c)`}function Ye(e,t){const n=new URLSearchParams(window.location.search);return n.delete(e),n.append(e,t),window.location.href+"?"+n.toString()}function et(e,t){return qe(this,void 0,void 0,(function*(){const n=yield fetch(e,{credentials:t?"include":void 0});if(!n.ok)throw new Error("Request failed. See the browser's network tab for details. URL: "+e);return yield n.json()}))}var tt=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))},nt=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};class st extends r.Component{constructor(e){super(e),this.state={}}componentDidUpdate(e){return tt(this,void 0,void 0,(function*(){if(this.props.recordedTestsUrl&&(e.expanded!==this.props.expanded&&this.setState({recordedTest:void 0}),this.props.expanded&&(e.expanded!==this.props.expanded||e.recordedTestsUrl!==this.props.recordedTestsUrl||e.testClassDescriptor!==this.props.testClassDescriptor||!He().isEqual(e.testFunctionDescriptor,this.props.testFunctionDescriptor)))){const e=yield et(this.getUrl()+"/recordedTest.json",this.props.includeCredentialsInJsonRequest);this.setState({recordedTest:e})}}))}getUrl(){var e;const t=this.props;return x.substringBefore(t.recordedTestsUrl,"/",!0)+"/"+(null===(e=t.testClassDescriptor)||void 0===e?void 0:e.name)+"/"+t.testFunctionDescriptor.functionName+"/"}render(){return(0,s.jsx)(ot,Object.assign({},this.props,{recordedTest:this.state.recordedTest,parent:this}),void 0)}}const rt=e=>(0,s.jsx)(N,{children:e.comment},void 0);function ot(e){var t,n;let{master:r,testClassDescriptor:i,testsToRun:c,testFunctionDescriptor:d,recordedTest:u,parent:p}=e,m=nt(e,["master","testClassDescriptor","testsToRun","testFunctionDescriptor","recordedTest","parent"]);return(0,s.jsxs)("div",Object.assign({className:"TestFunctionComponent"},{children:[(0,s.jsxs)(l.Z,Object.assign({className:"TestFunctionComponent_segment1",attached:!0},{children:[p&&!m.recordedTestsUrl&&(0,s.jsx)(v.Z,{label:"\xa0",checked:!0===(null===(t=null==c?void 0:c[i.name])||void 0===t?void 0:t[d.functionName]),onChange:()=>{c||(c={}),null==r||r.updateTestsToRun((0,$e.Uy)(c,(e=>{let t=e[i.name];t||(t=e[i.name]={}),t[d.functionName]?delete t[d.functionName]:t[d.functionName]=!0})))}},void 0),(0,s.jsxs)("h3",{children:[m.recordedTestsUrl&&(0,s.jsx)(Je.Z,{name:(m.expanded?"minus":"plus")+" square outline",link:!0,onClick:e=>{var t;return null===(t=m.onToggleExpanded)||void 0===t?void 0:t.call(m)}},void 0),d.scenario]},void 0)," \xa0",(0,s.jsx)(h.Z,Object.assign({horizontal:!0},{children:d.functionName}),void 0)]}),void 0),u&&(0,s.jsxs)(l.Z,Object.assign({className:"TestFunctionComponent_segment2",attached:!!p||"bottom",warning:!0},{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Z,{horizontal:!0,circular:!0,color:"orange",size:"small",content:"R"},void 0),"Recorded test ",p&&(0,s.jsx)("a",Object.assign({href:"#",onClick:e=>{p.setState({modalOpenAtScreenshotWithIndex:0}),e.preventDefault()}},{children:"(open)"}),void 0),"\xa0",m.showThumbnails&&(0,s.jsx)("br",{},void 0),(0,s.jsx)(h.Z,Object.assign({horizontal:!0,basic:!0,color:u.error?"red":"green"},{children:u.error?"FAILED":"PASSED"}),void 0),(0,s.jsxs)(h.Z,Object.assign({horizontal:!0,basic:!0},{children:["Duration: ",u.duration," ms"]}),void 0),m.additionalForSegment2]},void 0),p&&m.showThumbnails&&u.slides.map(((e,t)=>(0,s.jsx)(Ve.Z,{as:"a",href:"",src:p.getUrl()+e.screenshot+".png",size:"tiny",bordered:!0,onClick:e=>{p.setState({modalOpenAtScreenshotWithIndex:t}),e.preventDefault()}},e.screenshot))),p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{icon:"images outline",onClick:m.onToggleShowThumbnails,content:m.showThumbnails?"Hide thumbnails":"Show thumbnails"},void 0),(0,s.jsx)(a.Z,{icon:"film",onClick:e=>p.setState({modalOpenAtScreenshotWithIndex:0}),content:"Open"},void 0)]},void 0)]}),void 0),void 0!==(null==p?void 0:p.state.modalOpenAtScreenshotWithIndex)&&(0,s.jsx)(Ge,{parent:p,recordedTest:p.state.recordedTest,onClose:()=>p.setState({modalOpenAtScreenshotWithIndex:void 0}),testPath:p.getUrl(),currentSlide:p.state.modalOpenAtScreenshotWithIndex},void 0),p&&(null===(n=d.comments)||void 0===n?void 0:n.map(((e,t)=>(0,s.jsx)(o.Z,Object.assign({attached:t!=d.comments.length-1||"bottom",className:0===t?"TestFunctionComponent_segment3":""},{children:(0,s.jsx)(rt,{comment:e},void 0)}),t))))]}),void 0)}var at=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};class lt extends r.Component{constructor(){super(...arguments),this.state={}}render(){var e;let t=this.props,{master:n,testClassDescriptor:r,testsToRun:i}=t,a=at(t,["master","testClassDescriptor","testsToRun"]);const l=(null==r?void 0:r.name)||"There are no tests";return(0,s.jsxs)("div",Object.assign({className:"TestClassComponent"},{children:[(0,s.jsx)("div",Object.assign({className:"TestClassComponent_header"},{children:(0,s.jsx)("h1",{children:l},void 0)}),void 0),(0,s.jsx)(m.Z,{className:"TestClassComponent_divider"},void 0),(null==r?void 0:r.comments)&&(0,s.jsx)(ze.Z,{children:null===(e=null==r?void 0:r.comments)||void 0===e?void 0:e.map(((e,t)=>(0,s.jsx)(o.Z,{children:(0,s.jsx)(N,{children:e},void 0)},t)))},void 0),null==r?void 0:r.functions.map(((e,t)=>(0,s.jsx)(st,{master:n,includeCredentialsInJsonRequest:a.includeCredentialsInJsonRequest,testClassDescriptor:r,testsToRun:i,testFunctionDescriptor:e,recordedTestsUrl:a.recordedTestsUrl,expanded:this.state.expanded,onToggleExpanded:()=>this.setState({expanded:!this.state.expanded}),showThumbnails:this.state.showThumbnails,onToggleShowThumbnails:()=>this.setState({showThumbnails:!this.state.showThumbnails})},t)))]}),void 0)}}class ct extends r.Component{constructor(e){super(e),this.state={},this.componentDidUpdate()}componentDidUpdate(e){const t=this.props;if(t.testClassDescriptors===(null==e?void 0:e.testClassDescriptors)||!t.testsToRun)return;let n=!1;const s=(0,$e.Uy)(t.testsToRun,(e=>{for(let s of Object.getOwnPropertyNames(e)){const r=t.testClassDescriptors.find((e=>e.name===s));if(!r){delete e[s],n=!0;continue}const i=e[s];for(let e of Object.getOwnPropertyNames(i))r.functions.find((t=>t.functionName===e))||(delete i[e],n=!0)}}));n&&t.master.updateTestsToRun(s)}getShowLeftPane(){return!0}getTestClassDescriptors(){return this.props.testClassDescriptors}getAdditionalPropsForFeatureList(){return{localStorageKey:on}}getAdditionalPropsForTestClassComponent(){}renderTestClassComponent(){let{testsToRun:e,master:t}=this.props;return(0,s.jsx)(lt,Object.assign({master:t,testsToRun:e,testClassDescriptor:this.state.selectedDescriptor},this.getAdditionalPropsForTestClassComponent()),void 0)}render(){let{testsToRun:e,master:t}=this.props;if(!this.getShowLeftPane())return this.renderTestClassComponent();let n,r=e&&JSON.stringify(e);if(r){n=Ye(dn,r);const e=new URLSearchParams;e.append(dn,r),r="\\&"+e.toString()}const i=Ke(e);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(S,Object.assign({size:"25%",split:"vertical"},{children:[(0,s.jsxs)("div",Object.assign({className:"w100"},{children:[!this.getAdditionalPropsForTestClassComponent()&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,Object.assign({flowing:!0,on:"click",trigger:(0,s.jsx)(a.Z,{icon:"linkify",content:"Link"},void 0)},{children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:[Qe(e),": there are ",i.functionsChecked," test function(s) (in ",i.classesChecked," class(es)) checked to be ran."]},void 0),(0,s.jsxs)("p",{children:[(0,s.jsx)(h.Z,{circular:!0,content:"1"},void 0)," This ",(0,s.jsx)("a",Object.assign({href:n,target:"_blank"},{children:"shareable link"}),void 0)," contains in its search string the JSON for the checked tests to run."]},void 0),(0,s.jsxs)("p",{children:[(0,s.jsx)(h.Z,{circular:!0,content:"2"},void 0)," When launched from ",(0,s.jsx)("b",{children:"puppeteer"},void 0),", all the tests are ran. If you want to ",(0,s.jsx)("b",{children:"filter"},void 0),", then you can append a command line fragment to the puppeteer command line e.g. ",(0,s.jsx)(h.Z,Object.assign({horizontal:!0},{children:(0,s.jsx)("code",{children:"tad-puppeteer \\&testsToRun=..."},void 0)}),void 0),":"]},void 0),(0,s.jsx)(l.Z,{children:(0,s.jsx)("code",{children:r},void 0)},void 0),(0,s.jsx)(a.Z,{content:"Copy to clipboard",onClick:()=>{navigator.clipboard.writeText(r),alert("Copied to clipboard!")}},void 0)]},void 0):"No test is checked to run"}),void 0),(0,s.jsx)(a.Z,{disabled:this.props.running,icon:"play",content:"Run "+Qe(e),onClick:e=>t.run(!0)},void 0)]},void 0),this.getTestClassDescriptors()&&(0,s.jsx)(h.Z,Object.assign({basic:!0,horizontal:!0,color:"grey"},{children:Xe(this.getTestClassDescriptors())}),void 0),(0,s.jsx)(Pe,Object.assign({items:this.getTestClassDescriptors(),getIdForLocalStorage:e=>e.name,onSelect:e=>this.setState({selectedDescriptor:e}),renderItem:n=>{const r=e&&e[n.name]&&Object.getOwnPropertyNames(e[n.name]).length>0;return(0,s.jsxs)(s.Fragment,{children:[!this.getAdditionalPropsForTestClassComponent()&&(0,s.jsx)(v.Z,{checked:r,label:"\xa0",onChange:()=>{e||(e={}),null==t||t.updateTestsToRun((0,$e.Uy)(e,(e=>{if(r)delete e[n.name];else{const t=e[n.name]={};for(let e of n.functions)t[e.functionName]=!0}})))}},void 0),n.name]},void 0)}},this.getAdditionalPropsForFeatureList()),void 0)]}),void 0),this.renderTestClassComponent()]}),void 0)},void 0)}}var dt=n(28335),ht=n(92326),ut=n(12618),pt=n(29792),mt=n(29309);const vt=e=>{var t;const[n,i]=(0,r.useState)(-1),[l,c]=(0,r.useState)(-1),[d,h]=(0,r.useState)("");(0,r.useEffect)((()=>c(e.selectedIndexOnce||-1)),[e.selectedIndexOnce]);let u=-1;return(0,s.jsxs)("div",Object.assign({className:"w100"},{children:[e.onSetCurrent&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(mt.Z,{icon:"search",iconPosition:"left",placeholder:"Search...",value:d,action:d?{icon:"delete",color:"red",onClick:()=>h("")}:void 0,onChange:(e,t)=>h(t.value)},void 0)," (For found items, shows children, but doesn't show parents)"]},void 0),(0,s.jsx)(o.Z.Group,{children:null===(t=e.linearizedItems)||void 0===t?void 0:t.map(((t,r)=>d&&((u<0||t.indent<=u)&&(u=-1,t.name.toLowerCase().indexOf(d.toLowerCase())>=0&&(u=t.indent)),u<0)?null:(0,s.jsxs)(o.Z,Object.assign({secondary:r===n,tertiary:r===l,onMouseEnter:()=>i(r),onMouseLeave:()=>i(-1),onClick:()=>{var n;c(r),null===(n=e.onSelect)||void 0===n||n.call(e,t)}},{children:[(0,s.jsx)(gt,{width:t.indent},void 0),"CLASS"===t.kind?(0,s.jsx)(xt,{},void 0):(0,s.jsx)(bt,{},void 0),"\xa0",t.report&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(jt,{},void 0),"\xa0"]},void 0),t.failure&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(wt,{},void 0),"\xa0"]},void 0),(0,s.jsx)("span",Object.assign({style:{color:"METHOD"===t.kind?"#b1b1b1":void 0}},{children:t.name}),void 0)," ",(0,s.jsx)("i",Object.assign({style:{color:"#2185d0"}},{children:(0,s.jsx)(N,{children:t.description},void 0)}),void 0),e.onSetCurrent&&(0,s.jsx)(a.Z,{size:"mini",floated:"right",primary:!0,content:"Set current",onClick:()=>{var n;return null===(n=e.onSetCurrent)||void 0===n?void 0:n.call(e,t)}},void 0)]}),r)))},void 0)]}),void 0)},gt=e=>{let{width:t}=e;return(0,s.jsx)(s.Fragment,{children:new Array(4*t).fill(0).map(((e,t)=>(0,s.jsx)(r.Fragment,{children:"\xa0"},t)))},void 0)};var ft=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class St extends r.Component{constructor(){super(...arguments),this.state={}}fetchSafe(e,t){return ft(this,void 0,void 0,(function*(){const n=yield fetch(e,t);if(500===n.status){const e=yield n.json();throw this.setState({serverError:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("b",{children:"Path:"},void 0)," ",e.path,(0,s.jsx)("br",{},void 0),(0,s.jsx)("b",{children:"Message:"},void 0)," ",e.message]},void 0)}),new Error("Server error")}return n}))}componentDidMount(){return ft(this,void 0,void 0,(function*(){const e=yield(yield this.fetchSafe(this.props.serverUrlPrefix+"testGoodiesController/getTestsTree")).json(),t=this.linearizeNode(e,[],-1);this.setState({testsTreeRoot:e,linearizedItems:t}),this.setCurrent(localStorage.getItem(en),localStorage.getItem(tn))}))}runCurrent(){return ft(this,void 0,void 0,(function*(){this.setState({currentSelectedIndexAfterRun:void 0});let e=`${this.props.serverUrlPrefix}testGoodiesController/runTest?className=${this.state.currentClassName}`;this.state.currentMethodName&&(e+=`&methodName=${this.state.currentMethodName}`);const t=yield(yield this.fetchSafe(e)).json(),n=this.linearizeNode(t,[],-1);this.setState({testsTreeRoot:t,linearizedItems:n});const s=this.setCurrent(this.state.currentClassName,this.state.currentMethodName);this.setState({selectedItem:null==s?void 0:s.foundItem,currentSelectedIndexAfterRun:null==s?void 0:s.foundIndex})}))}linearizeNode(e,t,n,s,r){if(n++,s&&n<s.length&&s[n]!==e.name)return t;e.indent=n,n>0&&t.push(e),s&&n===s.length-1&&(r.foundIndex=t.length-1,r.foundItem=e);for(let i of e.children)s||(i.parent=e),this.linearizeNode(i,t,n,s,r);return t}setCurrent(e,t,n){null===e&&(e=void 0),null===t&&(t=void 0);const s={};if(e){const n=[];if(!this.deduceFullPath(this.state.testsTreeRoot,e,t,!1,n))return;const r=this.linearizeNode(this.state.testsTreeRoot,[],-1,n,s);this.setState({linearizedItemsCurrent:r})}else this.setState({linearizedItemsCurrent:void 0});return this.setState({currentClassName:e,currentMethodName:t}),n||(e?localStorage.setItem(en,e):localStorage.removeItem(en),t?localStorage.setItem(tn,t):localStorage.removeItem(tn)),s}deduceFullPath(e,t,n,s,r){if(s){if(e.name===n)return r.splice(0,0,e.name),!0}else if(e.name===t){if(!n)return r.splice(0,0,e.name),!0;s=!0}for(let i of e.children)if(this.deduceFullPath(i,t,n,s,r))return r.splice(0,0,e.name),!0;return!1}render(){const{selectedItem:e,serverError:t}=this.state;let n;(null==e?void 0:e.failure)&&(n=x.substringBefore(null==e?void 0:e.failure,"at"),n.length>100&&(n=n.substring(0,100)+"..."));const i="**Markdown** is supported. Words [within brackets] or ALL_CAPS are converted like this";return(0,s.jsxs)(S,Object.assign({size:"50%",split:"vertical"},{children:[(0,s.jsxs)("div",Object.assign({className:"w100"},{children:[t&&(0,s.jsxs)(g.Z,Object.assign({open:!0},{children:[(0,s.jsx)(g.Z.Header,{children:"Error"},void 0),(0,s.jsx)(g.Z.Content,{children:t},void 0),(0,s.jsx)(g.Z.Actions,{children:(0,s.jsx)(a.Z,{positive:!0,content:"OK",onClick:()=>this.setState({serverError:void 0})},void 0)},void 0)]}),void 0),(0,s.jsx)(a.Z,{icon:"play",content:"Run current",disabled:!this.state.currentClassName,onClick:()=>this.runCurrent()},void 0),(0,s.jsx)(a.Z,{icon:"delete",content:"Clear current",disabled:!this.state.currentClassName,onClick:()=>this.setCurrent()},void 0),(0,s.jsx)(d.Z,{trigger:(0,s.jsx)(Je.Z,{size:"big",color:"blue",name:"question circle"},void 0),wide:!0,content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(dt.Z,Object.assign({dividing:!0},{children:"Legend"}),void 0),(0,s.jsx)(xt,{},void 0)," Class",(0,s.jsx)("p",{},void 0),(0,s.jsx)(bt,{},void 0)," Method",(0,s.jsx)("p",{},void 0),(0,s.jsx)(jt,{},void 0)," Has report",(0,s.jsx)("p",{},void 0),(0,s.jsx)(wt,{},void 0)," Has error",(0,s.jsx)(m.Z,{},void 0),i,":",(0,s.jsx)("br",{},void 0)," ",(0,s.jsx)(N,{children:i},void 0)]},void 0)},void 0),(0,s.jsx)(m.Z,{},void 0),"Current: \xa0",this.state.currentClassName?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(xt,{},void 0)," ",this.state.currentClassName,(0,s.jsx)(bt,{},void 0)," ",this.state.currentMethodName,(0,s.jsx)(m.Z,{},void 0),(0,s.jsx)(vt,{linearizedItems:this.state.linearizedItemsCurrent,selectedIndexOnce:this.state.currentSelectedIndexAfterRun,onSelect:e=>this.setState({selectedItem:e})},void 0)]},void 0):"none",(0,s.jsx)(m.Z,{},void 0),(0,s.jsx)(vt,{linearizedItems:this.state.linearizedItems,onSelect:e=>this.setState({selectedItem:e}),onSetCurrent:e=>{"CLASS"===e.kind?this.setCurrent(e.name):this.setCurrent(e.parent.name,e.name)}},void 0)]}),void 0),(0,s.jsx)(ht.Z,{children:(0,s.jsx)(ut.Z,{panes:[{menuItem:"Markdown",render:()=>(0,s.jsx)(ut.Z.Pane,{children:(null==e?void 0:e.reportAsMarkdown)&&(0,s.jsx)(N,{children:null==e?void 0:e.reportAsMarkdown},void 0)},void 0)},{menuItem:"Initial, w/ custom renderers",render:()=>{var t;return(0,s.jsxs)(ut.Z.Pane,{children:[(null==e?void 0:e.failure)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(dt.Z,Object.assign({as:"h2",color:"red",dividing:!0},{children:[(0,s.jsx)(Je.Z,{name:"warning circle"},void 0),(0,s.jsxs)(dt.Z.Content,{children:["Error",(0,s.jsx)(dt.Z.Subheader,{children:n},void 0)]},void 0)]}),void 0),(0,s.jsx)("pre",{children:e.failure},void 0),(0,s.jsx)(m.Z,{},void 0)]},void 0),(null==e?void 0:e.description)&&(0,s.jsxs)(dt.Z,Object.assign({as:"h2",dividing:!0},{children:[(0,s.jsx)(Je.Z,{name:"film"},void 0),(0,s.jsxs)(dt.Z.Content,{children:[null==e?void 0:e.name,(0,s.jsx)(dt.Z.Subheader,{children:(0,s.jsx)(N,{children:null==e?void 0:e.description},void 0)},void 0)]},void 0)]}),void 0),null===(t=null==e?void 0:e.report)||void 0===t?void 0:t.elements.map(((e,t)=>{const n=Ct[e.type];return(0,s.jsx)(r.Fragment,{children:n?(0,s.jsx)(n,{element:e},void 0):(0,s.jsxs)("p",{children:["Unknown element type: ",e.type]},void 0)},t)}))]},void 0)}}]},void 0)},void 0)]}),void 0)}}const xt=()=>(0,s.jsx)(h.Z,{circular:!0,color:"green",content:"C"},void 0),bt=()=>(0,s.jsx)(h.Z,{circular:!0,color:"yellow",content:"M"},void 0),jt=()=>(0,s.jsx)(h.Z,{circular:!0,color:"orange",content:"R"},void 0),wt=()=>(0,s.jsx)(h.Z,{circular:!0,color:"red",content:"E"},void 0),Ct={ReportElementHeading:e=>{let{element:t}=e;return(0,s.jsx)(dt.Z,{children:(0,s.jsx)(N,{children:t.text},void 0)},void 0)},ReportElementParagraph:e=>{let{element:t}=e;return(0,s.jsx)("p",{children:(0,s.jsx)(N,{children:t.text},void 0)},void 0)},ReportElementCode:e=>{let{element:t}=e;return(0,s.jsx)(y.Z,Object.assign({language:t.language},{children:t.text}),void 0)},ReportElementTable:e=>{let{element:t}=e;var n;return(0,s.jsxs)(pt.Z,Object.assign({celled:!0},{children:[(0,s.jsx)(pt.Z.Header,{children:(0,s.jsx)(pt.Z.Row,{children:null===(n=t.rows[0])||void 0===n?void 0:n.cells.map(((e,t)=>(0,s.jsx)(pt.Z.HeaderCell,{children:e.text},t)))},void 0)},void 0),(0,s.jsx)(pt.Z.Body,{children:t.rows.map(((e,t)=>0===t?null:(0,s.jsx)(pt.Z.Row,{children:e.cells.map(((e,t)=>{let n;return null!==e.color&&void 0!==e.color&&(n={backgroundColor:x.convertColorToHex(e.color),color:x.convertColorToHex(x.getContrastingForegroundColor(e.color))}),(0,s.jsxs)(pt.Z.Cell,Object.assign({style:n},{children:[e.comment&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("small",{children:(0,s.jsx)("i",{children:(0,s.jsx)(N,{children:e.comment},void 0)},void 0)},void 0),(0,s.jsx)("br",{},void 0)]},void 0),(0,s.jsx)(N,{children:e.text},void 0)]}),t)}))},t)))},void 0)]}),void 0)}};function Tt(e){const t={};for(let n in e.table){const s=e.table[n];for(let e in s)t[e]=!0}return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(pt.Z,Object.assign({celled:!0,color:e.highlighted&&"yellow"},{children:[(0,s.jsx)(pt.Z.Header,{children:(0,s.jsx)(pt.Z.Row,{children:Object.getOwnPropertyNames(t).map((e=>(0,s.jsx)(pt.Z.HeaderCell,{children:e},e)))},void 0)},void 0),(0,s.jsx)(pt.Z.Body,{children:Object.getOwnPropertyNames(e.table).map((n=>(0,s.jsx)(pt.Z.Row,{children:Object.getOwnPropertyNames(t).map(((t,r)=>{var i,o,a;return(0,s.jsx)(pt.Z.Cell,Object.assign({className:(null===(i=e.highlighted)||void 0===i?void 0:i.id)==n&&(null===(o=e.highlighted)||void 0===o?void 0:o.field)===t?"MiniDbTableSetComponent_highlightedCell":""},{children:(null===(a=e.highlighted)||void 0===a?void 0:a.id)==n&&0===r?(0,s.jsx)(h.Z,Object.assign({ribbon:!0,color:"yellow"},{children:String(e.table[n][t])}),void 0):String(e.table[n][t])}),t)}))},n)))},void 0)]}),void 0)},void 0)}class yt extends r.Component{render(){var e;const t=null===(e=window.testsAreDemoMaster.slave.getTestsAreDemoFunctions())||void 0===e?void 0:e.miniDb;return t?(0,s.jsx)(s.Fragment,{children:Object.getOwnPropertyNames(t.data).sort().map((e=>{var n,r;return(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Z,{color:(null===(n=t.highlighted)||void 0===n?void 0:n.entityName)===e?"yellow":"teal",content:e},void 0),(0,s.jsx)(Tt,{table:t.data[e],highlighted:(null===(r=t.highlighted)||void 0===r?void 0:r.entityName)===e?t.highlighted:void 0},e)]},e)}))},void 0):null}}var Et=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const{MESSAGE_FOR_PUPPETEER:Nt}=ke;class It{constructor(){this.idOfLastMessage=0,this.idSent=-1}sendMessageToPuppeteer(e,t){return Et(this,void 0,void 0,(function*(){if(-1!==this.idSent)throw new Error(`A call to puppeteer is already in progress w/ id = ${this.idSent}. Somebody tries to send a new message w/ type = ${e} and content = ${JSON.stringify(t,void 0,2)}`);return this.idOfLastMessage++,this.idSent=this.idOfLastMessage,console.log(`${Nt} ${e} ${JSON.stringify(t)}`),setTimeout((()=>this.onPuppeteerFinished(this.idSent)),200),new Promise((e=>this.resolve=e))}))}onPuppeteerFinished(e){if(e!==this.idSent)throw new Error(`Received a message from puppeteer w/ id = ${e}, but the last message sent to puppeteer had id = ${this.idSent}`);this.idSent=-1,this.resolve&&(this.resolve(),this.resolve=void 0)}}var Dt=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class Ot extends r.Component{constructor(){super(...arguments),this.state={captureEnabled:!0}}onCapture(e,t){return Dt(this,void 0,void 0,(function*(){if(!this.state.captureEnabled)return!0;const n=yield new Promise((n=>{this.props.master.slave.setState({inspectedElement:e,inspectedElementPopup:this.renderQuestion(t,n)})}));if(this.props.master.slave.setState({inspectedElement:void 0,inspectedElementPopup:void 0}),n){const e=this.props.capturedUiApiCalls?this.props.capturedUiApiCalls+"\n":"";this.props.master.setState({capturedUiApiCalls:e+t})}return n}))}renderQuestion(e,t){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Fe,Object.assign({className:"",showLineNumbers:!1},{children:e}),void 0),(0,s.jsx)(a.Z,{positive:!0,content:"Continue",onClick:()=>t(!0)},void 0),(0,s.jsx)(a.Z,{negative:!0,content:"Cancel",onClick:()=>t(!1)},void 0)]},void 0)}render(){const e=this.props.capturedUiApiCalls||'/**\n* "Capture UiApi events" is enabled when this tab is opened \n* and "Capture enabled" == true\n*\n* 1/ Perform some actions in the UI\n* 2/ Captured events will appear here\n* 3/ Copy/paste in your project/TAD file(s)\n*/';return(0,s.jsx)(s.Fragment,{children:this.props.master.state.running?(0,s.jsx)(s.Fragment,{children:"This UI is disabled because a test is running. "},void 0):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(a.Z,{labelPosition:"left",content:"Capture enabled",onClick:()=>this.setState({captureEnabled:!this.state.captureEnabled}),icon:"square outline"+(this.state.captureEnabled?" check":""),color:this.state.captureEnabled?"green":void 0},void 0),(0,s.jsx)(a.Z,{icon:"erase",content:"Clear",onClick:()=>{this.props.master.setState({capturedUiApiCalls:void 0})}},void 0)]},void 0),(0,s.jsx)(Fe,{children:e},void 0)]},void 0)},void 0)}}var Ft=n(47471),Pt=n(95627),At=n(13250),kt=n(85554),Rt=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const{RECORDED_TESTS_INDEX:Mt}=ke;class Lt extends ct{constructor(e){let t;super(e);let n=!0;e.showLeftPane?(t=new URLSearchParams(window.location.search).get(hn),t||(t=localStorage.getItem(ln)||e.recordedTestsUrl,n=!1)):(t=e.recordedTestsUrl,n=!1);const s=localStorage.getItem(cn),r=s?JSON.parse(s):[];this.state={recordedTestsUrl:t,recordedTestsUrlEditing:t,recent:r},this.recordedTestsUrlChanged(t,n,t!==e.recordedTestsUrl)}recordedTestsUrlChanged(e,t,n){var s;return Rt(this,void 0,void 0,(function*(){let r;const i=null===(s=this.props.includeCredentialsInJsonRequestRegex)||void 0===s?void 0:s.test(e);try{const t=x.substringBefore(e,"/",!0);r=yield et(t+"/testClassDescriptors.json",i)}catch(o){}if(this.setState({recordedTestClassDescriptors:r,recordedTestsUrl:e,recordedTestsUrlEditing:e,includeCredentialsInJsonRequest:i}),t&&localStorage.setItem(ln,e),n){const{recent:t}=this.state,n=t.indexOf(e);let s;n<0?(s=t.slice(0,9),s.splice(0,0,e)):(s=[...t],s[0]=t[n],s[n]=t[0]),this.setState({recent:s}),localStorage.setItem(cn,JSON.stringify(s))}if(this.props.selectedTestClass&&r)for(let e of r)if(e.name===this.props.selectedTestClass){this.setState({selectedDescriptor:e});break}}))}componentDidUpdate(e){}getShowLeftPane(){return this.props.showLeftPane}getTestClassDescriptors(){return this.state.recordedTestClassDescriptors}getAdditionalPropsForFeatureList(){return{localStorageKey:an,selectedImposed:this.props.selectedTestClass}}getAdditionalPropsForTestClassComponent(){return{recordedTestsUrl:this.state.recordedTestsUrl,includeCredentialsInJsonRequest:this.state.includeCredentialsInJsonRequest}}render(){return(0,s.jsxs)("div",Object.assign({className:"FeaturebookUiRecorded"},{children:[this.getShowLeftPane()&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",Object.assign({className:"FeaturebookUiRecorded_bar"},{children:[(0,s.jsxs)("span",{children:[(0,s.jsxs)("b",{children:["URL for ",(0,s.jsx)("code",{children:Mt},void 0),":"]},void 0),"\xa0",(0,s.jsx)("br",{},void 0),(0,s.jsx)("a",Object.assign({href:Ye(hn,this.state.recordedTestsUrl),target:"_blank"},{children:"(shareable link)"}),void 0)]},void 0),(0,s.jsx)(mt.Z,{value:this.state.recordedTestsUrlEditing,onChange:(e,t)=>this.setState({recordedTestsUrlEditing:t.value})},void 0),"\xa0",this.state.recordedTestsUrlEditing!==this.state.recordedTestsUrl&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,Object.assign({color:"brown",basic:!0},{children:"Editing ..."}),void 0),(0,s.jsxs)(Ft.Z,{children:[(0,s.jsx)(a.Z,{positive:!0,content:"Apply",onClick:e=>this.recordedTestsUrlChanged(this.state.recordedTestsUrlEditing,!0,!0)},void 0),(0,s.jsx)(Pt.Z,{},void 0),(0,s.jsx)(a.Z,{negative:!0,content:"Cancel",onClick:e=>this.setState({recordedTestsUrlEditing:this.state.recordedTestsUrl})},void 0)]},void 0),"\xa0"]},void 0),(0,s.jsx)(a.Z,{content:"Default",onClick:e=>this.recordedTestsUrlChanged(this.props.recordedTestsUrl,!0,!1)},void 0),(0,s.jsx)(c.Z,Object.assign({text:"Recent",icon:"history",floating:!0,labeled:!0,button:!0,className:"icon",direction:"left"},{children:(0,s.jsx)(At.Z,{children:this.state.recent.map(((e,t)=>(0,s.jsx)(kt.Z,{icon:"history",text:e,onClick:t=>this.recordedTestsUrlChanged(e,!0,!0)},t)))},void 0)}),void 0)]}),void 0),(0,s.jsx)(m.Z,{},void 0)]},void 0),super.render()]}),void 0)}}var Zt=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};const{MESSAGE_FOR_PUPPETEER:_t,RECORDED_TESTS_DIR:Ut,RECORDED_TESTS_INDEX:Bt}=ke;var $t,zt,Wt;!function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON",e[e.CONTROLLED_BY_PROGRAM=2]="CONTROLLED_BY_PROGRAM"}($t||($t={})),function(e){e[e.TAD=0]="TAD",e[e.FB=1]="FB",e[e.FB_RECORDED=2]="FB_RECORDED",e[e.FB_SERVER=3]="FB_SERVER",e[e.DOC=4]="DOC",e[e.SCREENSHOTS=5]="SCREENSHOTS"}(zt||(zt={})),function(e){e[e.SRC=0]="SRC",e[e.TREE=1]="TREE",e[e.INSPECT=2]="INSPECT",e[e.MINI_DB=3]="MINI_DB",e[e.CAPTURE_UI_API_EVENTS=4]="CAPTURE_UI_API_EVENTS"}(Wt||(Wt={}));const Ht="testsAreDemo.stepByStep",Jt="testsAreDemo.autoRun",Vt="testsAreDemo.autoPressNext",Gt="testsAreDemo.endUser",qt="testsAreDemo.horizontalLayout",Kt="testsAreDemo.size1",Qt="testsAreDemo.size2",Xt="testsAreDemo.menuState",Yt="testsAreDemo.tabState",en="testsAreDemo.currentClassName",tn="testsAreDemo.currentMethodName",nn="testsAreDemo.currentDoc",sn="testsAreDemo.currentDirWithScreenshots",rn="testsAreDemo.testsToRun",on="testsAreDemo.currentTestClass",an="testsAreDemo.currentTestClassRecorded",ln="testsAreDemo.recordedTestsUrl",cn="testsAreDemo.recordedTestsUrlRecent",dn="testsToRun",hn="recordedTestsUrl",un=we("TestsAreDemoMaster",{nextStep:"",run:""});class pn extends r.Component{constructor(){super(...arguments),this.state={menuState:zt.FB,tabState:Wt.SRC,sidebar:!1,running:!1,loggedMessages:"",horizontalLayout:!1,autoPressNextEnabled:!1,stepByStepMode:$t.OFF,endUser:!1},this.testIdProp="data-testid",this.refMiniDbTableSetComponent=r.createRef(),this.refCaptureUiApiEvents=r.createRef(),this.puppeteerBridge=new It,this.onAutoPressTimerTick=()=>{this.state.autoPressNextAt&&x.now().getTime()>this.state.autoPressNextAt?(this.disableAutoPressTimerIfEnabled(!1),this.nextStep()):(this.setState({autoPressTimerId:setTimeout(this.onAutoPressTimerTick,1e3)}),this.forceUpdate())},this.onModifTabState=e=>{this.setState({tabState:e}),localStorage.setItem(Yt,""+e)},this.onStepByStepModeChanged=(e,t)=>{let{value:n}=t;const s=n;this.slave.stepByStep=s===$t.ON,localStorage.setItem(Ht,""+s),this.setState({stepByStepMode:s})},this.onModifSize1=e=>{this.setState({size1:e}),localStorage.setItem(Kt,""+e)},this.onModifSize2=e=>{this.setState({size2:e}),localStorage.setItem(Qt,""+e)},this.resetSizes=()=>{localStorage.removeItem(Kt),localStorage.removeItem(Qt),this.setState({size1:void 0,size2:void 0})},this.onModifMenuState=e=>{this.setState({menuState:e}),localStorage.setItem(Xt,""+e)}}get slave(){if(!this._slave)throw new Error("TestsAreDemoSlave (which should normally sit in the IFrame) did not connect to TestsAreDemoMaster");return this._slave}set slave(e){this._slave=e,this.readStepByStep(),this.forceUpdate(),this.getAutoRun()&&setTimeout((()=>this.run()))}onMochaReporterCreated(e,t,n){return new Te(this,e,t,n)}componentDidMount(){if(window.testsAreDemoMaster)throw new Error("Cannot create more than one instances of TestsAreDemoMaster");window.testsAreDemoMaster=this,"true"===localStorage.getItem(qt)&&this.setState({horizontalLayout:!0});const e=parseInt(localStorage.getItem(Kt)||"");isNaN(e)||this.setState({size1:e});const t=parseInt(localStorage.getItem(Qt)||"");isNaN(t)||this.setState({size2:t});const n=parseInt(localStorage.getItem(Xt)||"");isNaN(n)||this.setState({menuState:n});const s=parseInt(localStorage.getItem(Yt)||"");isNaN(s)||this.setState({tabState:s}),this.props.puppeteer||("true"===localStorage.getItem(Vt)&&this.setState({autoPressNextEnabled:!0}),"true"===localStorage.getItem(Gt)&&this.setState({endUser:!0}));const r=new URLSearchParams(window.location.search).get(dn)||!this.props.puppeteer&&localStorage.getItem(rn);r&&this.setState({testsToRun:JSON.parse(r)})}readStepByStep(){let e;const t=localStorage.getItem(Ht);e=this.props.forceStepByStep?$t.ON:this.props.puppeteer?$t.OFF:null===t||isNaN(Number(t))?$t.ON:Number(t),this.slave.stepByStep=e===$t.ON,this.setState({stepByStepMode:e})}getAutoRun(){return!!this.props.puppeteer||"false"!==localStorage.getItem(Jt)}updateTestsToRun(e){this.setState({testsToRun:e}),localStorage.setItem(rn,JSON.stringify(e))}log(e){this.setState({loggedMessages:this.state.loggedMessages+"\n"+e})}sendMessageToPuppeteer(e,t){console.log(`${_t} ${e} ${JSON.stringify(t)}`)}run(e){if(void 0===e&&(e=!1),this.state.menuState!==zt.TAD)if(e)this.onModifMenuState(zt.TAD);else if(!this.props.puppeteer)return;this.setState({running:!0,loggedMessages:""}),this.slave.run()}nextStep(){this.disableAutoPressTimerIfEnabled(),this.slave.hideSpotlight(),this.state.finishWaitingCallback(),this.setState({finishWaitingCallback:void 0}),this.slave.report.messageSentToPuppeteer=void 0}enableNextStepButton(e){this.setState({finishWaitingCallback:e}),this.state.autoPressNextEnabled&&this.enableAutoPressTimer()}disableAutoPressTimerIfEnabled(e){void 0===e&&(e=!0),e&&clearTimeout(this.state.autoPressTimerId),this.setState({autoPressNextAt:void 0,autoPressTimerId:void 0})}enableAutoPressTimer(){this.setState({autoPressNextAt:x.now().getTime()+3e3}),this.onAutoPressTimerTick()}getIFrameUrl(e,t,n){return e+t+"?"+n.toString()}renderIFramePane(){const e=new URLSearchParams(window.location.search);return e.delete("TestsAreDemo"),e.append("testsAreDemoSlave",""),(0,s.jsx)("div",Object.assign({className:"flex-container flex-grow"},{children:(0,s.jsx)("iframe",{width:"100%",height:"100%",src:this.getIFrameUrl(window.location.origin,window.location.pathname,e)},void 0)}),void 0)}renderTabs(){const{tabState:e}=this.state;return(0,s.jsxs)("div",Object.assign({className:"flex-container flex-grow"},{children:[(0,s.jsxs)(i.Z,Object.assign({attached:"top",tabular:!0},{children:[(0,s.jsx)(i.Z.Item,Object.assign({active:Wt.SRC===e,onClick:()=>this.onModifTabState(Wt.SRC)},{children:"Source"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:Wt.TREE===e,onClick:()=>this.onModifTabState(Wt.TREE)},{children:"Tree"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:Wt.INSPECT===e,onClick:()=>this.onModifTabState(Wt.INSPECT)},{children:"Inspect testid"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:Wt.MINI_DB===e,onClick:()=>this.onModifTabState(Wt.MINI_DB)},{children:"Mini DB"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:Wt.CAPTURE_UI_API_EVENTS===e,onClick:()=>this.onModifTabState(Wt.CAPTURE_UI_API_EVENTS)},{children:"Capture UiApi events"}),void 0)]}),void 0),(0,s.jsxs)(o.Z,Object.assign({attached:"bottom",className:"flex-grow flex-container "+(Wt.SRC===e?"no-padding-margin ":"")},{children:[Wt.SRC===e&&(0,s.jsx)(Oe,{sourceCodeInfo:this.state.sourceCodeInfo},void 0),Wt.TREE===e&&(0,s.jsx)("textarea",{readOnly:!0,wrap:"off",style:{width:"100%",height:"100%"},value:this.state.loggedMessages},void 0),Wt.INSPECT===e&&(0,s.jsxs)("div",{children:[(0,s.jsx)(a.Z,{icon:"search",color:this.state.inspecting?"brown":void 0,content:"Inspect testid",onClick:()=>this.slave.toggleInspect()},void 0),this.state.inspecting&&!this.state.inspectedElements&&(0,s.jsx)(l.Z,Object.assign({color:"brown"},{children:(0,s.jsx)(N,{children:`\nNo element w/ \`${this.testIdProp}\` found under the mouse pointer.\nMove the mouse over various elements. If nothing found, did you add cf. below? E.g.:\n\n\`\`\`\n<Button ${this.testIdProp}={testids.edit} ... />\n\`\`\`\n\nClick anywhere to end the "inspect" mode".\n            `},void 0)}),void 0),this.state.inspectedElements&&(0,s.jsxs)(s.Fragment,{children:[this.state.justCopiedToClipboard?(0,s.jsx)(a.Z,{color:"green",icon:"check",content:"Copied to clipboard!"},void 0):(0,s.jsx)(c.Z,Object.assign({text:"Copy code snippet for ...",icon:"copy outline",floating:!0,labeled:!0,button:!0,className:"icon brown"},{children:(0,s.jsxs)(c.Z.Menu,{children:[(0,s.jsx)(d.Z,{trigger:(0,s.jsx)(c.Z.Item,{text:"Selector",onClick:()=>this.copySnippet(this.getSnippet())},void 0),position:"right center",content:this.renderSnippet(this.getSnippet())},void 0),(0,s.jsx)(d.Z,{trigger:(0,s.jsx)(c.Z.Item,{text:"Selector + action",onClick:()=>this.copySnippet(this.getSnippet("action"))},void 0),position:"right center",content:this.renderSnippet(this.getSnippet("action"))},void 0),(0,s.jsx)(d.Z,{trigger:(0,s.jsx)(c.Z.Item,{text:"Selector + verification",onClick:()=>this.copySnippet(this.getSnippet("verification"))},void 0),position:"right center",content:this.renderSnippet(this.getSnippet("verification"))},void 0)]},void 0)}),void 0),(0,s.jsx)(a.Z,{color:"brown",content:"Clear",onClick:()=>this.setState({inspectedElements:void 0})},void 0),(0,s.jsxs)(l.Z,Object.assign({color:"brown"},{children:[(0,s.jsx)("code",{children:this.testIdProp},void 0),"s under mouse cursor (child > parent): ",(0,s.jsx)("br",{},void 0),this.state.inspectedElements.map(((e,t)=>(0,s.jsx)(h.Z,{color:"brown",content:e.getAttribute(this.testIdProp),onMouseEnter:()=>this.slave.setState({inspectedElement:e}),onMouseLeave:()=>this.slave.setState({inspectedElement:void 0})},t))),(0,s.jsx)("br",{},void 0),'Click anywhere to end "inspect" mode. Hover labels to focus.']}),void 0)]},void 0)]},void 0),Wt.MINI_DB===e&&(0,s.jsx)(yt,{ref:this.refMiniDbTableSetComponent},void 0),Wt.CAPTURE_UI_API_EVENTS===e&&(0,s.jsx)(Ot,{ref:this.refCaptureUiApiEvents,master:this,capturedUiApiCalls:this.state.capturedUiApiCalls},void 0)]}),void 0)]}),void 0)}getTestIdExpression(e){let t=x.substringAfter(e.getAttribute(this.testIdProp),"_");const n=t.split("_");return 1===n.length?t:`${n[0]} + "_${n[1]}"`}getSelectorExpression(e){let t="\t",n="";if(1===e.length)return{pre:t,result:`tad.screenCapturing.getByTestId(testids.${this.getTestIdExpression(e[0])})`};2===e.length?n="item":e.length>2&&(n="item1"),t+=`let ${n} = tad.screenCapturing.getByTestId(testids.${this.getTestIdExpression(e[e.length-1])});\n\t`;for(let s=e.length-2;s>=1;s--){const r=n;n="item"+(e.length-s),t+=`let ${n} = tad.withinCapturing(${r}).getByTestId(testids.${this.getTestIdExpression(e[s])});\n\t`}return{pre:t,result:`tad.withinCapturing(${n}).getByTestId(testids.${this.getTestIdExpression(e[0])})`}}getSnippet(e){const t=this.getSelectorExpression(this.state.inspectedElements);let n;return n="action"===e?`await tad.userEventWaitable.click(${t.result});`:"verification"===e?`await tad.assertWaitable.equal(${t.result}, "???");`:t.result+";",t.pre+n}renderSnippet(e){return(0,s.jsx)(N,{children:"```\n"+e+"\n```"},void 0)}copySnippet(e){return Zt(this,void 0,void 0,(function*(){yield navigator.clipboard.writeText(e),this.setState({justCopiedToClipboard:!0}),yield x.setTimeoutPromise(void 0,1e3),this.setState({justCopiedToClipboard:!1})}))}renderControlPanel(){let e="";this.state.autoPressNextAt&&(e=" ("+Math.round((this.state.autoPressNextAt-x.now().getTime())/1e3)+")");const t=[{key:$t.OFF,value:$t.OFF,text:"OFF"},{key:$t.ON,value:$t.ON,text:"ON"},{key:$t.CONTROLLED_BY_PROGRAM,value:$t.CONTROLLED_BY_PROGRAM,text:"Controlled by program"}];return(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Z,Object.assign({className:"TestsAreDemo_sidebar",as:o.Z,animation:"overlay",width:"very wide",visible:this.state.sidebar,onHide:()=>this.setState({sidebar:!1})},{children:(0,s.jsx)(p.Z,{children:(0,s.jsx)(p.Z.Row,Object.assign({columns:1},{children:(0,s.jsxs)(p.Z.Column,{children:[(0,s.jsx)(a.Z,{content:"Layout: "+(this.state.horizontalLayout?"horizontal":"vertical"),onClick:()=>{this.setState({horizontalLayout:!this.state.horizontalLayout}),this.resetSizes(),setTimeout((()=>localStorage.setItem(qt,""+this.state.horizontalLayout)))}},void 0),(0,s.jsx)(a.Z,{icon:"redo",content:"Reset sizes",onClick:this.resetSizes},void 0),(0,s.jsx)(m.Z,{className:"TestsAreDemo_divider"},void 0),(0,s.jsx)(v.Z,{checked:this.state.autoPressNextEnabled,label:"Auto press 'Next step' with timer",onChange:()=>{this.state.autoPressNextEnabled?this.disableAutoPressTimerIfEnabled():this.enableAutoPressTimer(),localStorage.setItem(Vt,""+!this.state.autoPressNextEnabled),this.setState({autoPressNextEnabled:!this.state.autoPressNextEnabled})}},void 0),(0,s.jsx)("br",{},void 0),(0,s.jsx)(v.Z,{checked:this.getAutoRun(),label:"Auto run after page load",onChange:()=>{localStorage.setItem(Jt,this.getAutoRun()?"false":"true"),this.forceUpdate()}},void 0),(0,s.jsx)("br",{},void 0),(0,s.jsx)(v.Z,{checked:this.state.endUser,label:"'Demo for end user' mode",onChange:()=>{localStorage.setItem(Gt,""+!this.state.endUser),this.setState({endUser:!this.state.endUser})}},void 0),(0,s.jsx)("br",{},void 0)]},void 0)}),void 0)},void 0)}),void 0),this.state.sidebar&&(0,s.jsx)(g.Z.Dimmer,{},void 0),(0,s.jsx)(a.Z,{icon:"bars",onClick:()=>this.setState({sidebar:!0})},void 0),(0,s.jsx)(c.Z,{className:"button icon",floating:!0,options:t,trigger:(0,s.jsxs)(s.Fragment,{children:["Step by step mode: ",t[this.state.stepByStepMode].text,"\xa0\xa0"]},void 0),value:this.state.stepByStepMode,onChange:this.onStepByStepModeChanged},void 0),(0,s.jsx)(a.Z,{"data-testid":un.run,icon:"play",content:"Run: "+Qe(this.state.testsToRun),disabled:this.state.running,onClick:()=>this.run()},void 0),this.state.finishWaitingCallback&&(0,s.jsx)(a.Z,{"data-testid":un.nextStep,icon:"step forward",content:"Next step"+e,onClick:()=>this.nextStep()},void 0),this.state.finishWaitingCallback&&(0,s.jsx)(a.Z,{icon:"forward",content:"Run normally",onClick:()=>{this.slave.stepByStep=!1,this.nextStep()}},void 0)]},void 0)}render(){if(this.props.puppeteer)return this.renderTad();const{menuState:e}=this.state;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.Z,Object.assign({style:{margin:"0"}},{children:[(0,s.jsx)(i.Z.Item,Object.assign({active:zt.FB===e,onClick:()=>this.onModifMenuState(zt.FB)},{children:"Featurebook (client)"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:zt.TAD===e,onClick:()=>this.onModifMenuState(zt.TAD)},{children:"Test run UI"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:zt.FB_RECORDED===e,onClick:()=>this.onModifMenuState(zt.FB_RECORDED)},{children:"Featurebook (recorded tests)"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:zt.FB_SERVER===e,onClick:()=>this.onModifMenuState(zt.FB_SERVER)},{children:"Featurebook (server)"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:zt.DOC===e,onClick:()=>this.onModifMenuState(zt.DOC)},{children:"Doc from tests (deprecated)"}),void 0),(0,s.jsx)(i.Z.Item,Object.assign({active:zt.SCREENSHOTS===e,onClick:()=>this.onModifMenuState(zt.SCREENSHOTS)},{children:"Screenshots from tests (deprecated)"}),void 0)]}),void 0),(0,s.jsxs)(o.Z,Object.assign({className:"TestsAreDemo_wrapperSegment",basic:!0},{children:[(0,s.jsx)("div",Object.assign({className:"TestsAreDemo_wrapperSegment",style:{display:zt.TAD===e?"flex":"none"}},{children:this.renderTad()}),void 0),zt.FB===e&&(0,s.jsx)(ct,{master:this,running:this.state.running,testClassDescriptors:this.state.testClassDescriptors,testsToRun:this.state.testsToRun},void 0),zt.FB_RECORDED===e&&(0,s.jsx)(Lt,{master:this,showLeftPane:!0,recordedTestsUrl:Ut+Bt},void 0),zt.FB_SERVER===e&&(0,s.jsx)(St,{serverUrlPrefix:this.props.serverUrlPrefix},void 0),zt.DOC===e&&(0,s.jsx)(Le,{},void 0),zt.SCREENSHOTS===e&&(0,s.jsx)(Be,{master:this},void 0)]}),void 0)]},void 0)}renderTad(){return this.props.puppeteer?this.renderIFramePane():this.state.horizontalLayout?(0,s.jsxs)(S,Object.assign({size:this.state.size1||"60%",split:"horizontal",onDragFinished:this.onModifSize1,onResizerDoubleClick:this.resetSizes},{children:[this.renderIFramePane(),this._slave?(0,s.jsxs)(S,Object.assign({split:"vertical",size:this.state.size2||"15%",onDragFinished:this.onModifSize2,onResizerDoubleClick:this.resetSizes},{children:[this.renderControlPanel(),this.renderTabs()]}),void 0):(0,s.jsx)("p",{children:"TestsAreDemoSlave not yet loaded"},void 0)]}),void 0):(0,s.jsxs)(S,Object.assign({size:this.state.size1||"30%",split:"vertical",onDragFinished:this.onModifSize1,onResizerDoubleClick:this.resetSizes},{children:[this._slave?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",Object.assign({className:"flex-container wh100"},{children:[this.renderControlPanel(),(0,s.jsx)(m.Z,{className:"TestsAreDemo_divider"},void 0),this.renderTabs()]}),void 0)},void 0):(0,s.jsx)("p",{children:"TestsAreDemoSlave not yet loaded"},void 0),this.renderIFramePane()]}),void 0)}}var mn=function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))};class vn extends r.Component{componentDidMount(){return mn(this,void 0,void 0,(function*(){if(vn.INSTANCE)throw new Error("Multiple instances of TestsAreDemoAppWrapper are not allowed.");vn.INSTANCE=this,this.props.importSemanticUiCss&&Promise.all([n.e(532),n.e(191)]).then(n.bind(n,1191))}))}render(){const e=this.props,t=new URLSearchParams(window.location.search);return t.has("TestsAreDemo")?(0,s.jsx)(pn,{puppeteer:t.has("puppeteer"),forceStepByStep:t.has("forceStepByStep"),serverUrlPrefix:e.serverUrlPrefix},void 0):t.has("testsAreDemoSlave")?(0,s.jsx)(de,{importTestsCallback:e.importTestsCallback,createTestsAreDemoFunctions:e.createTestsAreDemoFunctions},void 0):e.app}}vn.defaultProps={importSemanticUiCss:!1,serverUrlPrefix:""};r.Component},44351:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=n.p+"assets/images/demo-mode.md-ScheduledTask-49d31ee3058e6cc42419032b621e04d4.png"},37548:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s={text:'package com.crispico.leave_management;\n\nimport java.net.UnknownHostException;\n\nimport javax.inject.Inject;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.DependsOn;\nimport org.springframework.context.annotation.Import;\nimport org.springframework.context.annotation.Profile;\nimport org.springframework.core.env.Environment;\n\nimport com.crispico.foundation.server.ServerUtils;\nimport com.crispico.foundation.server.distributedTracing.DependenciesFinder;\nimport com.crispico.foundation.server.jhipster.generated.JhipsterRuntimeApp;\nimport com.crispico.foundation.server.jhipster.lib.config.JHipsterConstants;\nimport com.crispico.foundation.server.service.IServerFeatureParamsEntityService;\nimport com.crispico.foundation.server.service.settingsEntityService.SettingsCache;\nimport com.crispico.foundation.server.spring.FoundationServerApp;\nimport com.crispico.leave_management.demoMode.DemoModeServiceLeaveManagement;\nimport com.crispico.leave_management.feature_params.LeaveCustomCodeTest;\nimport com.crispico.leave_management.feature_params.LeaveFeatureParamsTest;\nimport com.crispico.leave_management.feature_params.LeaveNewCustomCodeTest;\nimport com.crispico.leave_management.feature_params.LeaveNewFeatureParamsTest;\nimport com.crispico.leave_management.performance_logging.PerformanceLoggingAspect;\nimport com.crispico.leave_management.service.EmployeeService.Color;\nimport com.crispico.leave_management.service.EmployeeService.EmployeeServiceDemoReportSettings;\nimport com.crispico.leave_management.service.EmployeeService.EmployeeServiceHeaderSettings;\nimport com.crispico.leave_management.service.TaskService;\n\nimport brave.Tracer;\nimport graphql.schema.GraphQLSchema;\nimport graphql.schema.idl.SchemaPrinter;\n/**\n * @author Cristian Spiescu\n */\n@FoundationServerApp\n@Import(LeaveManagementScheduledTaskConfig.class)\npublic class LeaveManagementApp extends JhipsterRuntimeApp {\n\t\n\tprotected static class AfterStartup {\n\t\t@Inject\n\t\tprotected IServerFeatureParamsEntityService featureParamsService;\n\n\t\t@Inject\n\t\tprotected LeaveCustomCodeTest leaveCustomCodeTest;\n\n\t\t@Inject\n\t\tprotected LeaveNewCustomCodeTest leaveNewCustomCodeTest;\n\t\t\n\t\t@Inject\n\t\tprotected Environment environment;\n\n\t\t@Inject\n\t\tprotected void postCreate(GraphQLSchema schema) {\n\t\t\tfeatureParamsService.addFeatureParam(LeaveFeatureParamsTest.class);\n\t\t\tfeatureParamsService.addCustomCode(leaveCustomCodeTest);\n\n\t\t\tfeatureParamsService.addFeatureParam(LeaveNewFeatureParamsTest.class);\n\t\t\tfeatureParamsService.addCustomCode(leaveNewCustomCodeTest);\n\n\t\t\t\n\t        SchemaPrinter schemaPrinter = new SchemaPrinter(SchemaPrinter.Options.defaultOptions());\n\t        System.out.println(schemaPrinter.print(schema));\n\t        System.out.println();\n\t\t}\n\t}\n\t\n\t@Autowired\n\tTracer tracer;\n\n\tpublic LeaveManagementApp(Environment env) {\n\t\tsuper(env);\n\t}\n\n\tpublic static void main(String[] args) throws UnknownHostException {\n\t\tJhipsterRuntimeApp.main(LeaveManagementApp.class, args);\n\t}\n\n\t@Bean\n\tprotected AfterStartup afterStartup() {\n\t\treturn new AfterStartup();\n\t}\n\n\t@Bean\n\t@DependsOn("performanceLoggingParameters")\n\t@ConditionalOnProperty(name = "foundation.performance-log.disable-default-aspect", havingValue = "true")\n\tpublic PerformanceLoggingAspect performanceLoggingAspect() {\n\t\tPerformanceLoggingAspect result = new PerformanceLoggingAspect();\n\t\treturn result;\n\t}\n\t\n\t@Bean\n\tpublic SettingsCache<TaskService.CreateDailyTasksSettings> createDailyTasksSettings() {\n\t\tTaskService.CreateDailyTasksSettings defaultValue = new TaskService.CreateDailyTasksSettings();\n\t\tdefaultValue.createInWeekend = false;\n\t\treturn new SettingsCache<>(defaultValue);\n\t}\n\n\t@Bean\n\tpublic SettingsCache<TaskService.TaskSalarySettings> taskSalarySettings() {\n\t\treturn new SettingsCache<>(new TaskService.TaskSalarySettings());\n\t}\n\t\n\t@Bean\n\tpublic SettingsCache<EmployeeServiceDemoReportSettings> employeeServiceDemoReportSettings() {\n\t\treturn new SettingsCache<>(new EmployeeServiceDemoReportSettings());\n\t}\n\t\n\t// #region settings1-bean\n\t@Bean\n\tpublic SettingsCache<EmployeeServiceHeaderSettings> employeeServiceHeaderSettings() {\n\t\treturn new SettingsCache<>(ServerUtils.jsonLike(new EmployeeServiceHeaderSettings(), s -> {\n\t\t\ts.showBasicSettingsButton = false;\n\t\t\ts.settingsButtonColor = Color.blue;\n\t\t\ts.postItMessage = "";\n\t\t}));\n\t}\n\t// #endregion\n\t\n\t@Bean\n\tpublic DependenciesFinder dependenciesFinder() {\n\t\treturn new DependenciesFinder();\n\t}\n\n// CS: am dezactivat zipkin pentru ca aveam multa poluare in consola; @see pom.xml\t\n\t\n//\t@Bean\n//\tpublic Sampler defaultSampler() {\n//\t\treturn Sampler.ALWAYS_SAMPLE;\n//\t}\n//\n//\t@Bean\n//\tpublic JdbcEventListener jdbcEventListner() {\n//\t\treturn new JdbcEventListener() {\n//\n//\t\t\tpublic Map<String, String> result = new TreeMap<>();\n//\t\t\tpublic List<Map<String, String>> results = new ArrayList<Map<String, String>>();\n//\n//\t\t\t@Override\n//\t\t\tpublic void onAfterResultSetGet(ResultSetInformation resultSetInformation, String columnLabel, Object value, SQLException e) {\n//\t\t\t\ttry {\n//\t\t\t\t\tString tableName = resultSetInformation.getResultSet().getMetaData().getTableName(1);\n//\t\t\t\t\tif (!result.containsKey("tableName")) {\n//\t\t\t\t\t\tresult.put("tableName", tableName);\n//\t\t\t\t\t}\n//\t\t\t\t} catch (SQLException e1) {\n//\t\t\t\t\te1.printStackTrace();\n//\t\t\t\t}\n//\t\t\t\tresult.put(convertColumnLabelToColumnName(columnLabel, resultSetInformation), value != null ? value.toString() : null);\n//\t\t\t}\n//\n//\t\t\t@Override\n//\t\t\tpublic void onAfterResultSetNext(ResultSetInformation resultSetInformation, long timeElapsedNanos, boolean hasNext, SQLException e) {\n//\t\t\t\tif (!result.isEmpty()) {\n//\t\t\t\t\tMap<String, String> resultCopy = new TreeMap<String, String>();\n//\t\t\t\t\tresultCopy.putAll(result);\n//\t\t\t\t\tresults.add(resultCopy);\n//\t\t\t\t\tresult.clear();\n//\t\t\t\t}\n//\t\t\t}\n//\n//\t\t\t@Override\n//\t\t\tpublic void onAfterCommit(ConnectionInformation connectionInformation, long timeElapsedNanos, SQLException e) {\n//\t\t\t\tSpan newSpan = tracer.currentSpan();\n//\t\t\t\ttry (Tracer.SpanInScope ws = tracer.withSpanInScope(newSpan.start())) {\n//\t\t\t\t\tnewSpan.tag("Query results", processResults(results));\n//\t\t\t\t} finally {\n//\t\t\t\t\tnewSpan.finish();\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println("Query results: " + processResults(results));\n//\t\t\t\tresults.clear();\n//\t\t\t}\n//\n//\t\t\tpublic String processResults(List<Map<String, String>> results) {\n//\t\t\t\tString tableName = null, resultAsString = "";\n//\t\t\t\tif (results.size() == 0) {\n//\t\t\t\t\treturn "[]";\n//\t\t\t\t}\n//\n//\t\t\t\tCollections.sort(results, new Comparator<Map<String, String>>() {\n//\t\t\t\t\t@Override\n//\t\t\t\t\tpublic int compare(Map<String, String> result1, Map<String, String> result2) {\n//\t\t\t\t\t\tString tableName1 = result1.get("tableName");\n//\t\t\t\t\t\tif (tableName1 == null) {\n//\t\t\t\t\t\t\t// CS: I don\'t know this code; but sometimes it enters here and would give a NPE\n//\t\t\t\t\t\t\t// I think the issue is deeper; because when this happens, the error persist; so\n//\t\t\t\t\t\t\t// the system is in a dubious state. To be investigated.\n//\t\t\t\t\t\t\treturn -1;\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\treturn tableName1.compareTo(result2.get("tableName"));\n//\t\t\t\t\t}\n//\t\t\t\t});\n//\n//\t\t\t\tfor (int i = 0; i < results.size(); i++) {\n//\t\t\t\t\tMap<String, String> result = results.get(i);\n//\n//\t\t\t\t\tString currentTableName = result.get("tableName");\n//\t\t\t\t\tif (currentTableName != "") {\n//\t\t\t\t\t\t// currentTableName can be empty when the query looks like "SELECT COUNT..."\n//\t\t\t\t\t\t// in this case, the table name can not be retrieved from ResultSetMetaData, but this query and its result can be seen on zipkin\n//\t\t\t\t\t\tif (currentTableName != tableName) {\n//\t\t\t\t\t\t\ttableName = currentTableName;\n//\t\t\t\t\t\t\tresultAsString += (i != 0 ? "\\n" : "") + "// " + currentTableName + "\\n " + "[";\n//\t\t\t\t\t\t}\n//\t\t\t\t\t\tresultAsString += result.toString() + (i == results.size() - 1 || (i + 1 < results.size() && results.get(i + 1).get("tableName") != currentTableName) ? "]" : ", \\n");\n//\t\t\t\t\t}\n//\t\t\t\t}\n//\t\t\t\treturn resultAsString;\n//\t\t\t}\n//\n//\t\t\tpublic String convertColumnLabelToColumnName(String columnLabel, ResultSetInformation resultSetInformation) {\n//\t\t\t\ttry {\n//\t\t\t\t\tResultSetMetaData metaData = resultSetInformation.getResultSet().getMetaData();\n//\t\t\t\t\tfor (int i = 1; i <= metaData.getColumnCount(); i++) {\n//\t\t\t\t\t\tif (metaData.getColumnLabel(i).toUpperCase().equals(columnLabel.toUpperCase())) {\n//\t\t\t\t\t\t\treturn metaData.getColumnName(i).toLowerCase();\n//\t\t\t\t\t\t}\n//\t\t\t\t\t}\n//\t\t\t\t} catch (SQLException e) {\n//\t\t\t\t\te.printStackTrace();\n//\t\t\t\t}\n//\t\t\t\treturn columnLabel;\n//\t\t\t}\n//\t\t};\n//\t}\n\t\n// TODO CS/UCS: cand va merge treaba, sa incercam ceva de genul:\n// deci ea ar crea bean-uri dinamic; \n//\t@Bean\n//\tpublic SettingsService settingsService() {\n//\t\treturn new SettingsService(CreateDailyTasksSettings.class, ...);\n//\t}\n\t\n\t// #region demo-mode-bean\n\t@Bean\n\t@Profile(JHipsterConstants.SPRING_PROFILE_TEST)\n\tpublic DemoModeServiceLeaveManagement demoModeService() {\n\t\treturn new DemoModeServiceLeaveManagement();\n\t}\n\t// #endregion\n}\n',path:"leave-management/leave-management-server/src/main/java/com/crispico/leave_management/LeaveManagementApp.java"}},63073:()=>{}}]);